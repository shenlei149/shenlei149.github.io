[Problem 145](https://projecteuler.net/problem=145 "Problem 145 - Project Euler")

有这样一些数 $n$，和所以数字逆着写的数 $\text{reverse}(n)$ 之和的所有数字都是奇数。比如 $36+63=99, 409+904=1313$ 等等，这些数我们称之为可逆数。有一个限制条件就是开头不能是 0。

问题是，小于十亿（1,000,000,000）的数中有多个可逆数。

这道题可以通过分类讨论来解决。

首先 $n$ 的长度是奇数和偶数明显是两类，因为这意味着有没有正好居于中间的数。对于奇数长度来说，有，且反过来还是该数字。

我们先来考虑长度是偶数的时候。

长度为 2 的时候，不妨把该数写作 $AB$，其逆就是 $BA$。以 $A+B$ 是否大于等于 10 来讨论。

大于等于 10 的情况，不妨令 $A+B=1C$，那么 $AB+BA=1(C+1)C$， $C$ 和 $C+1$ 奇偶性必然不同，不可能数字都是奇数。

小于 10 的情况，那么 $A+B$ 是奇数。$A$ 是偶数，可选 $2,4,6,8$，$B$ 是奇数，可选 $1,3,5,7,9$，之和小于 $10$ 的情况一共 10 种可能性。反之，$A$ 是奇数，$B$ 是偶数，也是 $10$ 种。

所以长度为 2 的可逆数一共 20 个。

长度为 4 的时候，该数可写作 $ABCD$，其逆就是 $DCBA$。以 $A+D$ 是否大于等于 10 来讨论。

大于等于 $10$ 的情况，不妨令 $A+B=1E$。若 $B+C$ 大于等于 10，和最后一位是 $E$，右起第四位是 $1+E$，不可能都是奇数；若 $B+C$ 小于 10，不能是 9，否则和的右起第二位是 0，不满足题意，如果是其他奇数，右起第二位和 $1+B+C$，而右起第三位是 $B+C$，也不可能同时是奇数。

小于 10 的情况，$A$ 和 $D$ 的取值可能性有 20 种，中间的 $BC$ 退化为长度为 2 的情况，取值的可能性有 30 种（偶数可以为0，因为不打头了），利用乘法原则，共有 600 个可逆数。

所以长度为 4 的可逆数一共 600 个。

长度为 6 的时候，该数可以写作 $ABCDEF$，其逆就是 $FEDCBA$。以 $A+F$ 是否可以大于等于 10 来讨论。

大于等于 10 的情况，原理和 4 位时一样，$B+E$ 不能大于等于 10。能小于 10 吗？为了保证 $B+E$ 得到的值和 $E+B+1$ 得到的值一样，那么 $C+D$ 就要大于 10。但是 $E+B$ 不进位，而 $D+C$ 进位，导致右起 3, 4 位一定不能同时是奇数。

小于 10 的情况，中间 4 个数回到了上一种情况，所以可能性是 $20 \times 30\times 30=18,000$。

所以长度为 6 的可逆数一共是 18,000 个。

长度为 8 的时候，该数可以写作 $ABCDEFGH$，其逆就是 $HGFEDCBA$。同样，以 $A+H$ 是否可以大于等于 10 来讨论。

在大于等于 10 的情况下，原理同上，$B+G$ 不能大于等于 10，那么 $B+G$ 就只能小于 10 了。同上，$C+F$ 就要大于等于 10。为了使得中间两位的奇偶性一致，那么 $E+D$ 要大于 10，结果就是右起第三位数字是 $C+F$ 模 10（因为 $B+G$ 小于 10），而右起第六位数字是 $C+F+1$ 模10，这俩不可能同时是奇数。

小于 10 的情况，中间六个数字回到了上一种情况，所以可逆数是 $20\times 30\times 30\times 30=540,000$。

所以长度为 8 的可逆数一共是 540,000 个。

现在来讨论 $n$ 的长度为奇数。

如果长度是 1，反过来是其本身，那么和是偶数，不符合题意。

长度是 3，可写作 $ABC$，可逆数是 $CBA$。中间数字的和是偶数，那么 $A+C$ 必须大于 10，为了右起第一位和第三位奇偶性相同，那么 $2B$ 不能进位，所以 $B$ 要小于等于4，那么 $B$ 有五种可取值；我们现在讨论 $A$ 和 $C$，$A$ 是奇数 $1,3,5,7,9$，$C$ 是偶数 $2,4,6,8$，其和大于 10 的可能性有 10 种可能性，$A$ 是偶数 $C$ 是奇数也有 10 种，那么可逆数是 $5\times(10+10)=100$。

长度是 5 时，可写作 $ABCDE$，可逆数是 $EDCBA$。中间是 $2C$，所以 $B+D$ 是大于等于 10 的，右起第一位是 $E+A$，但是右起第五位是 $A+E+1$，不可能同时是奇数，所以 $n$ 的长度不可能是 5。

长度为 $7$ 时，可写作 $ABCDEFG$，可逆数时 $GFEDCBA$。中间是 $2D$，所以 $C+E$ 是大于等于 10 的。根据前面的分析，$B+F$ 必须小于 10；进而 $2D$ 要小于 10。右起第六位会接受来此 $C+E$ 的进位，那么右起第二位也必须接受一个进位，所以 $A+G$ 必须大于 10。$2D$ 小于 10 得出 $D$ 有 5 种可能性，$A+G$ 大于 10 且和为奇数共有 20 种可能性，$C+E$ 大于 10 且和为奇数也有 20 种，$B+F$ 小于 10 且为偶数的可能性有 25 种。所以可逆数是 $5\times 20\times 20\times25=50,000$。

长度为 9 的时候，可写作 $ABCDEFGHI$，其可逆数是 $IHGFEDCBA$。由前面的分析可知 $D+F$ 要大于等于 10，那么为了让右起第三位 $G+C$ 和右起第七位 $C+G$ 同时为奇数，那么 $H+B$ 也必须大于 10，那么 $A+I$ 得到 $B+H$ 的进位，无法和右起第一位 $I+A$ 同奇偶，矛盾，所以长度不能是 9。

综上，小于十亿的可逆数是 608720 个。
