上一节我们讨论了如何求
$$P(x)y''+Q(x)y'+R(x)y=0\tag{1}$$
的在常点 $x_0$ 附近的解，其中 $P(x),Q(x),R(x)$ 是多项式。假定方程有解 $y=\phi(x)$ 且 $\phi$ 的泰勒级数
$$\phi(x)=\sum_{n=0}^\infty a_n(x-x_0)^n\tag{2}$$
在 $|x-x_0|<\rho,\rho>0$ 上收敛。将级数 $(2)$ 代入 $(1)$ 可以确定系数 $a_n$。

下面论证如果 $x_0$ 是 $(1)$ 的常点，那么存在形式如 $(2)$ 的解。接着讨论级数的收敛半径。为了做到这一点，还需要泛化常点的定义。

假定方程 $(1)$ 有形式如 $(2)$ 的解。将 $(2)$ 微分 $m$ 次并且令 $x=x_0$ 得到
$$m!a_m=\phi^{(m)}(x_0)\tag{3}$$
为了计算级数 $(2)$ 中的 $a_n$，必须要证明 $\phi^{(n)}(x_0),n=0,1,2,\cdots$ 可以从 $(1)$ 得到。

假定 $y=\phi(x)$ 是方程 $(1)$ 的解并且满足初始条件 $y(x_0)=y_0,y'(x_0)=y'_0$。那么 $a_0=y_0,a_1=y'_0$。如果没有指定初始条件，那么 $a_0,a_1$ 是任意值。为了确定 $\phi^{(n)}(x_0)$ 和对应的 $a_n,n=2,3,\cdots$，需要回到方程 $(1)$ 来找到 $\phi'',\phi''',\cdots$ 的公式。由于 $\phi$ 是方程 $(1)$ 的解，那么
$$P(x)\phi''(x)+Q(x)\phi'(x)+R(x)\phi(x)=0$$
包含 $x_0$ 的某个区间上 $P$ 不为零，那么得到
$$\phi''(x)=-p(x)\phi'(x)-q(x)\phi(x)\tag{4}$$
其中 $p(x)=Q(x)/P(x),q(x)=R(x)/P(x)$。在 $x=x_0$ 处，方程 $(4)$ 的右边是已知的，那么就可以计算得到 $\phi''(x_0)$。即
$$\phi''(x_0)=-p(x_0)\phi'(x_0)-q(x_0)\phi(x_0)=-p(x_0)a_1-q(x_0)a_0$$
令 $(3)$ 中的 $m=2$，那么可以确定对应的 $a_2$
$$2!a_2=\phi''(x_0)=-p(x_0)a_1-q(x_0)a_0\tag{5}$$
为了确定 $a_3$，对 $(4)$ 微分并且令 $x=x_0$ 得到
$$\begin{aligned}
3!a_3&=\phi'''(x_0)\\
&=-(p(x)\phi'(x)+q(x)\phi(x))'\bigg|_{x=x_0}\\
&=-2!p(x_0)a_2-(p'(x_0)+q(x_0))a_1-q'(x_0)a_0
\end{aligned}\tag{6}$$
将 $(5)$ 中的 $a_2$ 代入 $(6)$ 就用 $a_0,a_1$ 表示 $a_3$。

由于 $P,Q,R$ 是多项式且 $P(x_0)\neq 0$，那么 $p,q$ 在 $x_0$ 处的任意次微分都存在。因此可以继续对 $(4)$ 进行微分，确定每次的微分，并且令 $x=x_0$ 就可以得到 $a_4,a_5,\cdots$。

例 1 令 $y=\phi(x)$ 是初值问题 $(1+x^2)y''+2xy'+4x^2y=0,y(0)=0,y'(0)=1$。确定 $\phi''(0),\phi'''(0),\phi^{(4)}(0)$。

解：令微分方程中 $x=0$ 得到
$$\phi''(0)=0$$
对微分方程求导
$$(1+x^2)\phi'''(x)+2x\phi''(x)+2x\phi''(x)+2\phi'(x)+4x^2\phi'(x)+8x\phi(x)=0\tag{7}$$
令上式中 $x=0$ 得到
$$\phi'''(0)+2\phi'(0)=0$$
由于 $\phi'(0)=1$，得到
$$\phi'''(x)=-2\phi'(0)=-2$$
对 $(7)$ 求导
$$\begin{aligned}
&(1+x^2)\phi^{(4)}+2x\phi'''(x)\\
+&4x\phi'''(x)+4\phi''(x)\\
+&(2+4x^2)\phi''(x)+8x\phi'(x)\\
+&8x\phi'(x)+8\phi(x)\\
=&0
\end{aligned}$$
代入 $x=0$ 得到
$$\phi^{(4)}(0)+6\phi''(0)+8\phi(0)=0$$
由于 $\phi(0)=0,\phi''(0)=0$，得到
$$\phi^{(4)}(x)=0$$
我们在计算 $a_n$ 的过程中依赖了 $p,q$ 可以求任意阶导数这一属性。可以将 $p,q$ 是多项式之比这个条件放宽到 $p,q$ 在 $x_0$ 附近有任意阶导数吗？这个条件太弱了，无法保证 $y=\phi(x)$ 的级数展开收敛。这里的要求是函数 $p,q$ 在 $x_0$ 是可分析的（`analytic`），也就是说下面的泰勒级数在 $x_0$ 附近的某个区间收敛。
$$p(x)=p_0+p_1(x-x_0)+\cdots p_n(x-x_0)^n+\cdots=\sum_{n=-}^\infty p_n(x-x_0)^n\tag{8}$$
$$q(x)=q_0+q_1(x-x_0)+\cdots q_n(x-x_0)^n+\cdots=\sum_{n=-}^\infty q_n(x-x_0)^n\tag{9}$$
根据这一点来泛化方程 $(1)$ 的常点定义。如果 $p(x)=Q(x)/P(x),q(x)=R(x)/P(x)$ 在 $x_0$ 处可分析，那么点 $x_0$ 是方程 $(1)$ 的常点，否则是奇点。

下面讨论收敛区间这一问题。一种可能的方式是计算得到级数，然后通过测试级数收敛性的方法确定收敛性和收敛半径。但是上一节例 3 告诉我们计算得到系数 $a_n$ 很难，甚至是不可能的。不过对于这类问题，可以通过下面的定理来得到答案。

**定理 5.3.1**
> 如果 $x_0$ 是微分方程 $(1)$
> $$P(x)y''+Q(x)y'+R(x)y=0$$
> 的常点，也就是说说 $p(x)=Q(x)/P(x),q(x)=R(x)/P(x)$ 在 $x_0$ 处可分析，那么方程 $(1)$ 的通解是
> $$y=\sum_{n=0}^\infty a_n(x-x_0)^n=a_0y_1(x)+a_1y_2(x)$$
> 其中 $a_0,a_1$ 是任意常量，$y_1,y_2$ 是在 $x_0$ 处的幂级数解且是可分析的。$y_1,y_2$ 是方程的基础解系。$y_1,y_2$ 的收敛半径至少和 $p,q$ 的级数收敛半径的最小值一样大。

解的形式是 $y_1=1+b_2(x-x_0)^2+\cdots,y_2=(x-x_0)+c_2(x-x_0)^2\cdots$，其中 $b_2+c_2=a_2$。因此 $y_1$ 满足初始条件 $y_1(x_0)=0,y_1'(x_0)=0$，$y_2$ 满足初始条件 $y_2(x_0)=0,y_2'(x_0)=1$，因此 $W[y_1,y_2](x_0)=1$，因此它们是基础解析。

虽然可以通过对微分方程不停的微分来计算 $a_n$，但是通常这不是一个实际的方法。应该类似上一小节所示，将级数 $(2)$ 代入方程 $(1)$ 中，然后对比对应项确定系数。

这里不会给出定理的证明。重要的是形如 $(2)$ 的级数解存在，并且级数解的收敛半径不小于 $p,q$ 的级数收敛半径较小的值。

有两种方法确定收敛半径。一种是计算出级数然后判定。不过，当 $P(x),Q(x),R(x)$ 是多项式时有更简单的方法。从复变函数理论中可知两个多项式之比 $Q(x)/P(x)$，如果 $P(x)\neq 0$，在点 $x=x_0$ 处的幂级数展开收敛。并且假定 $P(x),Q(x)$ 的公因子已经抵消，那么 $Q(x)/P(x)$ 在 $x=x_0$ 处的级数的收敛半径是 $x_0$ 到 $P(x)$ 最近的零点的距离。要记住，$P(x)=0$ 可能有复数根。

例 2 $(1+x^2)^{-1}$ 在 $x=0$ 处的泰勒级数的收敛半径是多少？

解：一种方式是求其泰勒展开
$$\frac{1}{1+x^2}=1-x^2+x^4-x^6+\cdots+(-1)^{-n}x^{2n}+\cdots$$
通过比值法能够确定 $\rho=1$。另一个方法是计算 $1+x^2$ 的零点是 $x=\pm i$，在复平面上 0 到这两个点的距离都是 1，因此收敛半径是 1。

例 3 求 $(x^2-2x+2)^{-1}$ 在 $x=0$ 处的泰勒级数的收敛半径是多少？在 $x=1$ 处的收敛半径呢？

解：求
$$x^2-2x+2=0$$
的根 $x=1\pm i$，距离 $x=0$ 的长度都是 $\sqrt{2}$。因此收敛半径是 $\sqrt{2}$。

距离 $x=1$ 的长度都是 1，因此收敛半径是 1。

根据定理 5.3.1，例 2 和例 3 中艾里方程的级数解对所有 $x,x-1$ 都收敛，这是因为问题中 $P(x)=1$ 没有零点。

级数解的收敛区间可能要比定理 5.3.1 给定的要大，定理仅仅是给出了下界，下面这个例子会阐述这一点。

例 4 确定勒让德方程在 $x=0$ 处的级数解的收敛半径的下界。
$$(1-x^2)y''-2xy'+\alpha(\alpha+1)y=0$$
其中 $\alpha$ 是常量。

解：这里 $P(x)=1-x^2,Q(x)=-2x,R(x)=\alpha(\alpha+1)$ 都是多项式，那么 $P$ 的零点 $x=\pm 1$，距离 $x=0$ 的长度是 1，因此形如 $\sum_{n=0}^\infty a_nx^n$ 解至少在 $|x|<1$ 上收敛，实际收敛区间可能会更大。如果 $\alpha$ 是正数，一个解是无穷级数，另一个解是多项式，因此对所有 $x$ 都收敛。详见最后部分关于勒让德方程的讨论。

例 5 求解微分方程
$$(1+x^2)y''+2xy'+4x^2y=0\tag{10}$$
在 $x=0,x=-\frac{1}{2}$ 处的级数解的收敛半径的下界。

解：$P,Q,R$ 都是多项式，$P$ 的零点是 $x=\pm i$。在复平面上，从 0 到 $\pm i$ 的距离是 1，从 $-\frac{1}{2}$ 到 $\pm i$ 的距离是 $\frac{\sqrt{5}}{2}$。因此对于第一种情况，级数 $\sum_{n=0}^\infty a_nx^n$ 至少在 $|x|<1$ 上收敛。对于第二种情况，级数 $\sum_{n=0}^\infty b_n(x+\frac{1}{2})^n$ 至少在 $|x+\frac{1}{2}|<\frac{\sqrt{5}}{2}$ 上收敛。

从定理 3.2.1 的视角看，假定给定初始条件 $y(0)=y_0,y'(0)=y'_0$，由于 $1+x^2\neq 0$，这个初值问题在 $-\infty<x<\infty$ 上都存在唯一解。从定理 5.3.1 的角度看，仅保证 $\sum_{n=0}^\infty a_nx^n,a_0=y_0,a_1=y'_0$ 在 $-1<x<1$ 上收敛。在 $-\infty<x<\infty$ 上的唯一解在 $x=0$ 可以没有对所有 $x$ 都收敛的幂级数。

例 6 能否求解微分方程
$$y''+(\sin x)y'+(1+x^2)y=0$$
在 $x=0$ 处的级数解？如果能收敛半径是多少？

解：对于这个微分方程 $p(x)=\sin x$，这个函数在 $x=0$ 处的泰勒展开对所有 $x$ 都收敛；$q(x)=1+x^2$，本身就是在 $x=0$ 处的泰勒级数，也对所有 $x$ 都收敛。因此存在幂级数解，并且对所有 $x$ 都收敛。

### 勒让德方程
勒让德方程方程是
$$(1-x^2)y''-2xy'+\alpha(\alpha+1)y=0$$
根据前面的例 4，$x=0$ 是常点，收敛半径是 1。这里进需要考虑 $\alpha>-1$ 的情况，因为对于 $a\leq -1$ 时，令 $\alpha=-(1+\gamma),\gamma>0$，代入得到 $(1-x^2)y''-2xy'+\gamma(\gamma+1)y=0$，仍旧是勒让德方程。

勒让德方程在数学物理领域非常有用，比如求解球坐标系下的拉普拉斯方程
$$\frac{d^2F(\phi)}{d\phi^2}+\cot\phi\frac{dF(\phi)}{d\phi}+n(n+1)F(\phi)=0,0<\phi<\pi$$
这里 $n=\alpha$。令 $x=\cos\phi$，那么 $y=f(x)=F(\arccos x)$，因此有
$$\frac{dF}{d\phi}=\frac{df}{dx}\frac{dx}{d\phi}=y'(-\sin\phi)$$
$$\begin{aligned}
\frac{d^2F}{d\phi^2}&=\frac{d}{d\phi}(y'(-\sin\phi))\\
&=y'(-\cos\phi)+(-\sin\phi)\frac{dy'}{dx}\frac{dx}{d\phi}\\
&=-xy'+(-\sin\phi)y''(-\sin\phi)\\
&=-xy'+(\sin^2\phi)y''\\
&=(1-x^2)y''-xy'
\end{aligned}$$
代入拉普拉斯方程
$$(1-x^2)y''-xy'-xy'+n(n+1)y=(1-x^2)y''-2xy'+n(n+1)y=0$$
这就是勒让德方程。

假定解是
$$y=\sum_{n=0}^\infty a_nx^n$$
那么
$$y'=\sum_{n=1}^\infty na_nx^{n-1}$$
$$y''=\sum_{n=1}^\infty n(n-1)a_nx^{n-2}$$
代入勒让德方程 $x^n$ 对应的系数相等，得到
$$(n+2)(n+1)a_{n+2}=-(n+\alpha+1)(\alpha -n)a_n$$
那么偶数项和奇数项分别确定，那么
$$a_2=-\frac{\alpha(\alpha+1)}{2!}a_0,a_4=\frac{\alpha(\alpha-2)(\alpha+1)(\alpha+3)}{4!}a_0$$
$$a_3=-\frac{(\alpha-1)(\alpha+2)}{3!}a_1,a_5=\frac{(\alpha-1)(\alpha-3)(\alpha+2)(\alpha+4)}{5!}a_1$$
因此
$$\begin{aligned}
y_1(x)&=1-\frac{\alpha(\alpha+1)}{2!}x^2+\frac{\alpha(\alpha-2)(\alpha+1)(\alpha+3)}{4!}x^4\\
&+\sum_{m=3}^\infty(-1)^m\frac{\alpha\cdots(\alpha-2m+2)(\alpha+1)\cdots(\alpha+2m-1)}{(2m)!}x^{2m}
\end{aligned}$$
$$\begin{aligned}
y_2(x)&=x-\frac{(\alpha-1)(\alpha+2)}{3!}x^3+\frac{(\alpha-1)(\alpha-3)(\alpha+2)(\alpha+4)}{5!}x^5\\
&+\sum_{m=3}^\infty(-1)^m\frac{(\alpha-1)\cdots(\alpha-2m+1)(\alpha+2)\cdots(\alpha+2m)}{(2m+1)!}x^{2m+1}
\end{aligned}$$
当 $\alpha$ 是偶数时，$y_1$ 变成了多项式，当 $m=n+1$ 之后的项为零。
$$y_1=1,\alpha=0$$
$$y_1=1-3x^2,\alpha=2$$
$$y_1=1-10x^2+\frac{(4)(2)(5)(7)}{4!}x^4=1-10x^2+\frac{35}{3}x^4,\alpha=4$$
当 $\alpha$ 是奇数时，$y_2$ 变成了多项式，当 $m=n+1$ 之后的项为零。
$$y_2=x,\alpha=1$$
$$y_2=x-\frac{5}{3}x^3,\alpha=3$$
$$y_2=x-\frac{(4)(7)}{3!}x^3+\frac{(4)(2)(7)(9)}{5!}x^5=x-\frac{14}{3}x^3+\frac{21}{5}x^5,\alpha=5$$
勒让德多项式 $P_n(x)$ 是 $\alpha=n$ 勒让德方程解对应的多项式，并且需要满足 $P_n(1)=1$。
$$P_0(x)=1$$
$$P_1(x)=x$$
$n=2$ 时，多项式是 $1-3x^2$，代入 $x=1$ 得到 $-2$，因此需要乘以 $-\frac{1}{2}$，因此
$$P_2(x)=\frac{3x^2-1}{2}$$
$n=3$ 时，多项式是 $x-\frac{5}{3}x^3$，代入 $x=1$ 得到 $-\frac{2}{3}$，因此需要乘以 $-\frac{3}{2}$，因此
$$P_3(x)=\frac{5x^3-3x}{2}$$
