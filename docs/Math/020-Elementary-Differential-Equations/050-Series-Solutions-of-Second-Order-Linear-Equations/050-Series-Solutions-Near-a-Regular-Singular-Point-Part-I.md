下面讨论如何求解二阶线性微分方程
$$P(x)y''+Q(x)y'+R(x)y=0\tag{1}$$
在正则奇点 $x=x_0$ 附近的解。为了方便，假定 $x_0=0$，如果 $x_0\neq 0$，可以通过令 $x-x_0=t$ 使得正则奇点在原点。

$x=0$ 是 $(1)$ 的正则奇点意味着 $xQ(x)/P(x),x^2R(x)/P(x)$ 在 $x\to 0$ 时极限存在并且在 $x=0$ 处是可分析的。因此它们在某个区间 $|x|<\rho,rho>0$ 上有收敛的幂级数
$$xp(x)=\sum_{n=0}^\infty p_nx^n,x^2q(x)=\sum_{n=0}^\infty q_nx^n\tag{2}$$
为了让 $xp(x),x^2q(x)$ 出现在方程中，将 $(1)$ 除以 $P(x)$ 再乘以 $x^2$
$$x^2y''+x(xp(x))y'+(x^2q(x))y=0\tag{3}$$
也可以展开为
$$x^2y''+x(p_0+p_1x+\cdots+p_nx^n+\cdots)y'+(q_0+q_1x_1+\cdots+q_nx^n+\cdots)y=0\tag{4}$$
$xp(x),x^2q(x)$ 的第一项是
$$p_0=\lim_{x\to 0}\frac{xQ(x)}{P(x)},q_0=\lim_{x\to 0}\frac{x^2R(x)}{P(x)}\tag{5}$$
如果 $(2)$ 中所有其他系数 $p_n,q_n,n\geq 1$ 都是零，那么方程 $(4)$ 就简化为欧拉方程
$$x^2y''+p_0xy'+q_0y=0\tag{6}$$
不过一般地，其他系数 $p_n,q_n,n\geq 1$ 中有一些或全都都不为零。即便如此方程 $(4)$ 在奇点附近的解的基本特征与 $(6)$ 的解的特征一致。$p_1x+\cdots+p_nx^n+\cdots,q_1x_1+\cdots+q_nx^n+\cdots$ 这些项的出现只不过是让计算更复杂罢了。

这里主要讨论 $x>0$ 的情况。$x<0$ 的区间可以和之前求解欧拉方程一样，令 $x=-\xi$ 来求解 $\xi >0$ 的方程。

方程 $(4)$ 的系数可以看作是欧拉系数乘以幂级数。方程 $(4)$ 中 $y'$ 的系数可以写为
$$p_0x\bigg(1+\frac{p_1}{p_0}x+\frac{p_2}{p_0}x^2+\cdots+\frac{p_n}{p_0}x^n\cdots\bigg)$$
$y$ 的系数也可以做类似处理。因此一个自然的 猜测是 $(4)$ 的解的形式是欧拉解乘以幂级数。因此可以假设
$$y=x^r(a_0+a_1x+\cdots+a_nx^n+\cdots)=x^r\sum_{n=0}^\infty a_nx^n=\sum_{n=0}^\infty a_nx^{n+r}\tag{7}$$
其中 $a_0\neq 0$。也就是说 $r$ 是级数第一个非零项的指数，$a_0$ 是它的系数。作为解的一部分，我们需要求解：

1. 方程 $(1)$ 有形式如 $(7)$ 的解，$r$ 的值是多少？
2. 系数 $a_n$ 的递归关系是什么？
3. 级数 $\sum_{n=0}^\infty a_nx^n$ 的收敛半径是多少？

弗罗贝尼乌斯（`Frobenius`）构建了相关的基本定理，并且相当复杂。因此这里和后续小节，我们假定存在这样形式的解。具体说来假定解中出现的幂级数都有非零的收敛半径，我们更专注于如何求解级数的系数。在解释弗罗贝尼乌斯方法之前，先来看一个示例。

例 1 求微分方程
$$2x^2y''-xy'+(1+x)y=0\tag{8}$$
解：方程 $(8)$ 的奇点是 $x=0$，因此 $xp(x)=-1/2,x^2q(x)=(1+x)/2$。因此 $p_0=-1/2,q_0=1/2,q_1=1/2$，其余的 $p_n,q_n$ 是零。从 $(6)$ 可以得到，$(8)$ 对应的欧拉方程是
$$2x^2y''-xy'+y=0\tag{9}$$
为了求解 $(8)$，我们假定有形式如 $(7)$ 的解，那么 $y',y''$ 分别是
$$y'=\sum_{n=0}^\infty a_n(r+n)x^{r+n-1}\tag{10}$$
$$y''=\sum_{n=0}^\infty a_n(r+n)(r+n-1)x^{r+n-2}\tag{11}$$
代入 $(8)$ 得到
$$\begin{aligned}
2x^2y''-xy'+(1+x)y=&\sum_{n=0}^\infty 2a_n(r+n)(r+n-1)x^{r+n}\\
&-\sum_{n=0}^\infty a_n(r+n)x^{r+n}+\sum_{n=0}^\infty a_nx^{r+n}+\sum_{n=0}^\infty a_nx^{r+n+1}
\end{aligned}\tag{12}$$
上式右边最后一项可以写作 $\sum_{n=1}^\infty a_{n-1}x^{r+n}$，代入 $(12)$ 得到
$$\begin{aligned}
2x^2y''-xy'+(1+x)y=&a_0[2r(r-1)-r+1]x^r\\
&+\sum_{n=0}^\infty((2(r+n)(r+n-1)-(r+n)+1)a_n+a_{n-1})x^{r+n}\\
&=0
\end{aligned}\tag{13}$$
上式要对所有的 $x$ 都成立，那么 $x$ 的系数都要是零。由于 $a_0\neq 0$，那么
$$2r(r-1)-r+1=2r^2-3r+1=(r-1)(2r-1)=0\tag{14}$$
方程 $(14)$ 称为指标方程（`indicial equation`）。这个多项式方程可以从方程 $(8)$ 对应的欧拉方程 $(9)$ 得到。指标方程的根是
$$r_1=1,r_2=\frac{1}{2}$$
$r$ 是正则奇点 $x=0$ 在奇点处的指数（`exponents at the singularity`），它决定了解 $(7)$ 在奇点附近的定性行为。

回到方程 $(13)$，$x^{r+n}$ 的系数要为零，那么
$$(2(r+n)(r+n-1)-(r+n)+1)a_n+a_{n-1}=0,n\geq 1\tag{16}$$
得到
$$\begin{aligned}
a_n&=-\frac{a_{n-1}}{2(r+n)^2+3(r+n)+1}\\
&=-\frac{a_{n-1}}{((r+n)-1)(2(r+n)-1)},n\geq 1
\end{aligned}\tag{17}$$
对不同的根 $r_1,r_2$，利用 $(17)$ 确定系数 $a_1,a_2,\cdots,a_n$ 的值。对于 $r=r_1=1$，那么
$$a_n=\frac{a_{n-1}}{(2n+1)n}$$
因此
$$\begin{aligned}
a_1&=-\frac{a_0}{3\cdot 1}\\
a_2&=-\frac{a_1}{5\cdot 2}=\frac{a_0}{(3\cdot 5)(1\cdot 2)}\\
a_3&=-\frac{a_2}{7\cdot 3}=-\frac{a_0}{(3\cdot 5\cdot 7)(1\cdot 2\cdot 3)}
\end{aligned}$$
通项公式是
$$a_n=\frac{(-1)^n}{(3\cdot 5\cdot 7\cdots(2n+1))n!}a_0,n\geq 4\tag{18}$$
上式分子分母同时乘以 $2\cdot 4\cdot 6\cdots 2n=2^n n!$，那么得到
$$a_n=\frac{(-1)^n2^n}{(2n+1)!}a_0,n\geq 1$$
如果忽略常量 $a_0$，方程 $(8)$ 的一个解是
$$y_1(x)=x\bigg(1+\sum_{n=1}^\infty\frac{(-1)^n2^n}{(2n+1)!}x^n\bigg),x>0\tag{19}$$
为了确定 $(19)$ 中级数的收敛半径，这里使用比值测试法
$$\lim_{n\to\infty}\bigg|\frac{a_{n+1}x^{n+1}}{a_nx^n}\bigg|=\lim_{n\to\infty}\frac{2|x|}{(2n+2)(2n+3)}=0$$
因此级数对所有 $x$ 都收敛。

当 $r=r_2=\frac{1}{2}$ 时，$(17)$ 是
$$a_n=-\frac{a_{n-1}}{2n(n-\frac{1}{2})}=-\frac{a_{n-1}}{n(2n-1)},n\geq 1$$
因此
$$\begin{aligned}
a_1&=-\frac{a_0}{1\cdot 1}\\
a_2&=-\frac{a_1}{2\cdot 3}=\frac{a_0}{(1\cdot 2)(1\cdot 3)}\\
a_3&=-\frac{a_2}{3\cdot 5}=-\frac{a_0}{(1\cdot 2\cdot 3)(1\cdot 3\cdot 5)}
\end{aligned}$$
通项公式是
$$a_n=\frac{(-1)^n}{n!(1\cdot 3\cdot 5\cdots(2n-1))}a_0,n\geq 4\tag{20}$$
分子分母同时乘以 $2\cdot 4\cdot 6\cdot 2n=2^n n!$，那么
$$a_n=\frac{(-1)^n2^n}{(2n)!}a_0,n\geq 1$$
忽略常量 $a_0$ 得到第二个解
$$y_2(x)=x^{1/2}\bigg(1+\sum_{n=1}^\infty\frac{(-1)^n2^n}{(2n)!}\bigg),x>0\tag{21}$$
和之前类似，很容易验证 $(21)$ 中的级数也对所有 $x$ 都收敛。因为 $y_1,y_2$ 在 $x=0$ 的行为分别类似于 $x,x^{1/2}$，所以它们是线性独立的。因此 $(8)$ 的通解是
$$y=c_1y_1(x)+c_2y_2(x),x>0$$
上面的例子阐述了在奇点 $x=0$ 附近有时有两个形如 $(7)$ 的解。类似的，如果正则奇点是 $x=x_0$，那么两个解的形式是
$$y=(x-x_0)^r\sum_{n=0}^\infty a_n(x-x_0)^n\tag{22}$$
就像欧拉方程有时没有两个形式的解 $y=x^r$ 一样，有正则奇点的更一般的方程也有可能没有两个形式如 $(7)$ 或 $(22)$。 下一节我们会看到，如果指标方程的根 $r_1,r_2$ 相等或者差值是一个整数，那么第二个解会有更复杂的形式。不管那种情况，$(7)$ 或者 $(22)$ 会找到至少一个解，如果 $r_1,r_2$ 差值是整数，这个解对应着 $r$ 较大的情况。如果只有一个解，那么第二个解涉及对数项，类似于欧拉方程的特征方程有相同的根。降阶法或其他一些方法可以用于寻找第二个解，下面两个小节会讨论。

如果指标方程的根是复数，那么不会相等或者差值是整数，因此总是有两个形式为 $(7)$ 或 $(22)$ 的解。这些解是 $x$ 的复变函数。和欧拉方程一样，可以通过取复数的实部和虚部来获得实数解。

最后提一个实践的点，如果 $P,Q,R$ 是多项式，直接使用方程 $(1)$ 会比 $(3)$ 更简单。因为无需将 $xQ(x)/P(x),x^2R(x)/P(x)$ 表示为幂级数。比如解
$$x(1+x)y''+2y'+xy=0$$
就不要改写为
$$x^2y''+\frac{2x}{1+x}y'+\frac{x^2}{1+x}y=0$$
后者需要将 $\frac{2x}{1+x},\frac{x^2}{1+x}$ 展开成幂级数。
