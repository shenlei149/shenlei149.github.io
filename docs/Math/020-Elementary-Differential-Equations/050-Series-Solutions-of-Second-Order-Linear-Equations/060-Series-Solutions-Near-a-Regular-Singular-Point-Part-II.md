下面回到求方程
$$L[y]=x^2y''+x(xp(x))y'+(x^2q(x))y=0\tag{1}$$
的解这个更一般的问题上。
其中
$$xp(x)=\sum_{n=0}^\infty p_nx^n,x^2q(x)=\sum_{n=0}^\infty q_nx^n\tag{2}$$
这两个级数在区间 $|x|<\rho,\rho>0$ 上收敛。点 $x=0$ 是正则奇点，相应的欧拉方程是
$$x^2y''+p_0xy'+q_0y=0\tag{3}$$
为了求解方程 $(1)$ 在 $x>0$ 上的解，假定解的形式是
$$y=\phi(r,x)=x^r\sum_{n=0}^\infty a_nx^n=\sum_{n=0}^\infty a_nx^{r+n}\tag{4}$$
其中 $a_0\neq 0$。这里写作 $y=\phi(r,x)$ 是为了强调 $\phi$ 即依赖于 $r$ 也依赖于 $x$。

那么可以得到
$$y'=\sum_{n=0}^\infty(r+n)a_nx^{r+n-1},y''=\sum_{n=0}^\infty(r+n)(r+n-1)a_nx^{r+n-2}\tag{5}$$
将 $(2),(4),(5)$ 代入到方程 $(1)$ 得到
$$\begin{aligned}
L[\phi(r,x)]&=a_0r(r-1)x^r+a_1(r+1)rx^{r+1}+\cdots+a_n(r+n)(r+n-1)x^{r+n}+\cdots\\
&+(p_0+p_1x+\cdots+p_nx^n+\cdots)(a_0rx^r+a_1(r+1)x^{r+1}+\cdots+a_n(r+n)x^{r+n}+\cdots)\\
&+(q_0+q_1x+\cdots+q_nx^n+\cdots)(a_0x^r+a_1x^{r+1}+\cdots+a_nx^{r+n}+\cdots)\\
&=0
\end{aligned}$$
将无穷级数相乘并合并同类项得到
$$\begin{aligned}
L[\phi(r,x)]&=a_0F(r)\\
&+[a_1F(r+1)+a_0(p_1r+q_1)]x^{r+1}\\
&+[a_2F(r+2)+a_0(p_2r+q_2)+a_1(p_1(r+1)+q_1)]x^{r+2}\\
&+\cdots\\
&+[a_nF(r+n)+a_0(p_nr+q_n)+a_1(p_{n-1}(r+1)+q_{n-1})+\cdots+a_{n-1}(p_1(r+n-1)+q_1)]x^{r+n}\\
&+\cdots\\
&=0
\end{aligned}$$
即
$$L[\phi]=a_0F(r)x^r+\sum_{n=1}^\infty\bigg(F(r+n)a_n+\sum_{k=0}^{n-1}a_k((r+k)p_{n-k}+q_{n-k})\bigg)x^{r+n}=0\tag{6}$$
其中
$$F(r)=r(r-1)+p_0r+q_0\tag{7}$$
方程 $(6)$ 对于所有 $x>0$，$x$ 的各个幂次的系数都要为零。

由于 $a_0\neq 0$，$x^r$ 的系数 $F(r)=0$。这个方程前面提到过，就是指标方程，这个方程可以从求欧拉方程 $(3)$ 的解 $y=x^r$ 得到。下面假设方程的两个根 $r_1,r_2$ 是实数的话有 $r_1\geq r_2$。如果是复数，根的这总假定就没有意义了。仅对这些根 $r$ 可以得到方程 $(1)$ 的形如 $(4)$ 的解。$r_1,r_2$ 是奇点处的指数，它们决定了在奇点附近解的定性性质。

令 $(6)$ 中 $x^{r+n}$ 的系数为零得到递归关系
$$F(r+n)a_n+\sum_{k=0}^{n-1}a_k((r+k)p_{n-k}+q_{n-k})=0,n\geq 1\tag{8}$$
上式表明一般情况下 $a_n$ 依赖于 $r$ 和 $a_0,a_1,\cdots,a_{n-1}$。如果 $F(r+1),F(r+2),\cdots,F(r+n),\cdots$ 不为零，我们可以用 $a_0$ 和 $xp(x),x^2q(x)$ 级数的系数计算出 $a_1,a_2,\cdots,a_n,\cdots$。只有 $r=r_1,r=r_2$ 使得 $F(r)=0$。由于 $r_1\geq r_2$，那么 $r_1+n,n\geq 1$ 不等于 $r_1,r_2$。那么 $F(r_1+n)\neq 0,n\geq 1$。因此我们总是可以得到一个形如 $(4)$ 的方程 $(1)$ 的解
$$y_1(x)=x^{r_1}\bigg(1+\sum_{n=1}^\infty a_n(r_1)x^n\bigg),x>0\tag{9}$$
这里使用记号 $a_n(r_1)$ 强调 $(8)$ 确定 $a_n$ 需要依赖于 $r_1$。这个解涉及任意常量，解 $(9)$ 中令 $a_0=1$。

如果 $r_2$ 不等于 $r_1$ 并且 $r_1-r_2$ 不是一个整数，那么 $r_2+n,n\geq 1$ 不等于 $r_1$，那么 $F(r_2+n)\neq 0$，这样就可以得到第二个解
$$y_2(x)=x^{r_2}\bigg(1+\sum_{n=1}^\infty a_n(r_2)x^n\bigg),x>0\tag{10}$$
如在 5.3 小节讨论的常点附近的级数解类似，$(9),(10)$ 中的级数至少在 $xp(x),x^2q(x)$ 的级数收敛区间 $|x|<\rho$ 上收敛。在收敛半径内，级数 $1+\sum_{n=1}^\infty a_n(r_1)x^n,1+\sum_{n=1}^\infty a_n(r_2)x^n$ 所定义的函数在 $x=0$ 处是可分析的。因此如果存在解 $y_1,y_2$，那它们在奇点的行为由级数前面的因子 $x^{r_1},x^{r_2}$ 来决定。

为了得到 $x<0$ 的解，仅需用 $x=-\xi,\xi>0$ 替换即可。和之前的欧拉方程的解类似，$(9),(10)$ 中的 $x^{r_1},x^{r_2}$ 要替换为 $|x|^{r_1},|x|^{r_2}$。

如果 $r_1,r_2$ 是复数，那么复共轭，因此 $r_1\neq r_2+N$，其中 $N$ 是任意整数。因此总是可以求得两个形如 $(4)$ 的解，不过它们是 $x$ 的复变函数。通过取其复数解的实部和虚部可以得到实数解。

稍后我们会讨论 $r_1=r_2$ 或 $r_1-r_2=N$ 的情况。

值得注意的是，$r_1,r_2$ 很容易求解，并且它们确定了解的定性行为。只需要求解二次方程
$$r(r-1)+p_0r+q_0=0\tag{11}$$
就可以得到 $r_1,r_2$。其中系数是
$$p_0=\lim_{x\to 0}xp(x),q_0=\lim_{x\to 0}x^2q(x)\tag{12}$$
注意，上述条件是必须进行评估的，因为这是正则奇点的条件，因此这些计算在分析早期就需要进行。

如果 $x=0$ 是微分方程
$$P(x)y''+Q(x)y'+R(x)y=0\tag{13}$$
的奇点，其中 $P,Q,R$ 是多项式，那么 $xp(x)=xQ(x)/P(x),x^2q(x)=x^2R(x)/P(x)$，因此
$$p_0=\lim_{x\to 0}x\frac{Q(x)}{P(x)},q_0=\lim_{x\to 0}x^2\frac{R(x)}{P(x)}\tag{14}$$
最后，$(9),(10)$ 中级数的收敛半径至少等于原点到除了正则奇点 $x=0$ 之外 $P$ 的零点的最小距离。

例 1 讨论微分方程
$$2x(1+x)y''+(3+x)y'-xy=0$$
在奇点附近的性质。

解：这个方程形式是 $(13)$，$P(x)=2x(1+x),Q(x)=3+x,R(x)=-x$。因此奇点是 $x=0,x=-1$。由于
$$\lim_{x\to 0}x\frac{Q(x)}{P(x)}=\lim_{x\to 0}x\frac{3+x}{2x(1+x)}=\frac{3}{2}$$
$$\lim_{x\to 0}x^2\frac{R(x)}{P(x)}=\lim_{x\to 0}x^2\frac{-x}{2x(1+x)}=0$$
所有 $x=0$ 是正则奇点。从公式 $(14)$ 可以得到 $p_0=\frac{3}{2},q_0=0$，那么指标方程是 $r(r-1)+\frac{3}{2}r=0$，那么根是 $r_1=0,r_2=-\frac{1}{2}$。由于这两个根不相等且差值不是整数，因此有两个解
$$y_1(x)=1+\sum_{n=1}^\infty a_n(0)x^n,y_2(x)=|x|^{-1/2}\bigg(1+\sum_{n=1}^\infty a_n(-\frac{1}{2})x^n\bigg),0<|x|<\rho$$
收敛的下界是 1，也就是 $x=0$ 到 $x=-1$ 的距离。当 $x\to 0$ 时，解 $y_1$ 有界，是可分析的，$y_2$ 会趋于无穷。

点 $x=-1$ 也是正则奇点，因为
$$\lim_{x\to -1}(x+1)\frac{Q(x)}{P(x)}=\lim_{x\to -1}\frac{(x+1)(3+x)}{2x(1+x)}=-1$$
$$\lim_{x\to -1}(x+1)^2\frac{R(x)}{P(x)}=\lim_{x\to -1}\frac{(x+1)^2(-x)}{(2x(1+x))}=0$$
此时，$p_0=-1,q_0=0$，那么指标方程是 $r(r-1)-r=0$。根是 $r_1=2,r_2=0$。较大的根对应的解的形式是
$$y_1(x)=(x+1)^2\bigg(1+\sum_{n=1}^\infty a_n(2)(x+1)^n\bigg)$$
级数至少在 $|x+1|<1$ 上收敛，$y_1$ 此时是可分析的。由于两个根差值是整数，或许存在或许不存在形式为
$$y_x(x)=1+\sum_{n=1}^\infty a_n(0)(x+1)^n$$
的解，需要进一步的分析。

这个例子中没有涉及复杂的运算，就能得到关于解的很多信息。

下面考虑根相同或者差值是正整数 $r_1-r_2=N$ 的情况。我们至少对于较大的根可以得到形式如 $(9)$ 的解。与欧拉方程类似，如果 $r_1=r_2$，第二个解包含对数项。这一点对于差值为整数时或许也成立。

### 相同的根
这里求第二个解的方法与 5.4 小节求欧拉方程的第二个解的方法相同。考虑 $r$ 是连续的并通过递归关系 $(8)$ 来求解 $a_n$，其是 $r$ 的函数。对于 $n\geq 1$ 时 $a_n$ 的选择，$(6)$ 中的 $x^{r+1},x^{r+2},x^{r+3},\cdots$ 的系数均为零。因此，由于 $r_1$ 是 $F(r)$ 的根，那么 $(6)$ 化简为
$$L[\phi](r,x)=a_0F(r)x^r=a_0(r-r_1)^2x^r\tag{15}$$
令 $r=r_1$，那么 $L[\phi](r_1,x)=0$，这就得到了由 $(9)$ 给出的解 $y_1$。更重要的是，类似于分析欧拉方程，才能够 $(15)$ 还可以得到
$$\begin{aligned}
L[\frac{\partial\phi}{\partial r}](r_1,x)&=a_0\frac{\partial}{\partial r}(x^r(r-r_1)^2)\bigg|_{r=r_1}\\
&=a_0((r-r_1)^2x^r\ln x+2(r-r_1)x^r)\bigg|_{r=r_1}\\
&=0
\end{aligned}$$
因此方程 $(1)$ 的第二个解是
$$\begin{aligned}
y_2(x)&=\frac{\partial\phi(r,x)}{\partial r}\\
&\frac{\partial}{\partial r}\bigg(x^r\bigg(a_0+\sum_{n=1}^\infty a_n(r)x^n\bigg)\bigg)\bigg|_{r=r_1}\\
&=(x^{r_1}\ln x)\bigg(a_0+\sum_{n=1}^\infty a_n(r_1)x^n\bigg)+x^{r_1}\sum_{n=1}^\infty a_n'(r_1)x^n\\
&=y_1(x)\ln x+x^{r_1}\sum_{n=1}^\infty a_n'(r_1)x^n,x>0
\end{aligned}\tag{17}$$
其中 $a_n'(r_1)$ 是在 $r=r_1$ 处的导数 $\frac{da_n}{dr}$。

尽管 $(17)$ 给出了一个 $y_2(x)$ 的显式表达，但是直接从递归关系 $(8)$ 中得到 $a_n$ 作为 $r$ 的函数然后对 $r$ 求导是比较困难的。一个备选方法是假定 $y$ 有 $(17)$ 形式的解，即
$$y=y_1(x)\ln x+x^r_1\sum_{n=1}^\infty b_nx^n,x>0\tag{18}$$
其中 $y_1(x)$ 已经求解得到了。和之前一样，将上式代入微分方程，合并同类项，$x$ 的各次幂的系数为零，计算得到 $b_n$。第三种可行的方法是已知 $y_1(x)$ 后使用降阶法求 $y_2(x)$。

### 根 $r_1,r_2$ 相差整数 $N$
对于这种情况，第二个解的推导相当复杂这里就不展开了。这个形式如后面定理中给出的 $(24)$。$(24)$ 中的 $c_n(r_2)$ 定义是
$$c_n(r_2)=\frac{d}{dr}[(r-r_2)a_n(r)]\bigg|_{r=r_2},n=1,2,3,\cdots\tag{19}$$
其中 $a_n(r)$ 由递归关系 $(8)$ 定义，并且 $a_0=1$。$(24)$ 中系数 $a$ 是
$$a=\lim_{r\to r_2}(r-r_2)a_N(r)\tag{20}$$
如果 $a_N(r_2)$ 是有限的，那么 $a=0$ 且 $y_2$ 不包含对数项。

实践中，计算 $a$ 是否为零的最好方法是尝试计算对应 $r_2$ 的 $a_n$ 并尝试求解 $a_N(r_2)$。如果可以，就没有任何问题了。如果不行，不得不用 $a\neq 0$ 的 $(24)$。

当 $r_1-r_2=N$，有三种方法求第二个解。第一个就是将 $(24)$ 代入 $(1)$ 直接计算 $a,c_n(r_2)$。第二个方法是通过 $(19),(20)$ 计算 $a,c_n(r_2)$。如果是一个正常的过程，在计算 $r=r_1$ 的解时，计算得到 $a_n$ 的通项公式而不仅仅是 $a_n(r_1)$。第三个方式是降阶法。

下面的定理总结了三种情况。

**定理 5.6.1**
> 考虑微分方程 $(1)$
> $$x^2y''+x(xp(x))y'+(x^2q(x))y=0$$
> 其中 $x=0$ 是正则奇点。$xp(x),x^2q(x)$ 在 $x=0$ 处可分析，收敛级数展开是
> $$xp(x)=\sum_{n=0}^\infty p_nx^n,x^2q(x)=\sum_{n=0}^\infty q_nx^n$$
> $|x|<\rho,\rho>0$，$\rho$ 是两个幂级数收敛半径较小的一个。令 $r_1,r_2$ 是指标方程
> $$r(r-1)+p_0r+q_0=0$$
> 的根，如果是实数，那么 $r_1>r_2$。那么在区间 $-\rho<x<0$ 或区间 $0<x<\rho$ 上存在解
> $$y_1(x)=|x|^{r_1}\bigg(1+\sum_{n=1}^\infty a_n(r_1)x^n\bigg)\tag{21}$$
> 其中 $a_n(r_1)$ 由递归关系 $(8)$ 定义，且 $a_0=1,r=r_1$。
>
> 下面分三种情况：
>
> 如果 $r_1-r_2$ 不为零或正整数，那么在区间 $-\rho<x<0$ 或区间 $0<x<\rho$ 上存在解
> $$y_2(x)=|x|^{r_2}\bigg(1+\sum_{n=1}^\infty a_n(r_2)x^n\bigg)\tag{22}$$
> 其中 $a_n(r_2)$ 由递归关系 $(8)$ 定义，且 $a_0=1,r=r_2$。$(21),(22)$ 中的级数至少在 $|x|<\rho$ 上收敛。
>
> 如果 $r_1=r_2$，那么第二个解是
> $$y_2(x)=y_1(x)\ln |x|+|x|^{r_1}\sum_{n=1}^\infty b_n(r_1)x^n\tag{23}$$
>
> 如果 $r_1-r_2=N$，一个正整数，那么
> $$y_2(x)=ay_1(x)\ln |x|+|x|^{r_2}\bigg(1+\sum_{n=1}^\infty c_n(r_2)x^n\bigg)\tag{24}$$
> 系数 $a_n(r_1),b_n(r_1),c_n(r_2)$ 和常量 $a$ 可以通过将式子代入 $(1)$ 求解。系数 $a$ 可能为零，此时 $(24)$ 没有对数项。$(23),(24)$ 中级数至少在 $|x|<\rho$ 上收敛，并且是一个在 $x=0$ 附近可分析的函数。
>
> 这三种情况下，解 $y_1(x),y_2(x)$ 是微分方程的基础解系。
