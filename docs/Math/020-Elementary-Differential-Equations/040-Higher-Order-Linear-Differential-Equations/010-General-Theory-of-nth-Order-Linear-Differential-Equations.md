$n$ 阶线性微分方程的形式是
$$P_0(t)\frac{d^n y}{dt^n}+P_1(t)\frac{d^{n-1} y}{dt^{n-1}}+\cdots+P_{n-1}\frac{dy}{dt}+P_n(t)y=G(t)\tag{1}$$
我们假定函数 $P_0,P_1,\cdots,P_n,G$ 是在区间 $I:\alpha<t<\beta$ 上连续的实函数，在这个区间上 $P_0$ 不会为零。那么两边同时除以 $P_0(t)$ 得到
$$L[y]=\frac{d^n y}{dt^n}+p_1(t)\frac{d^{n-1} y}{dt^{n-1}}+\cdots+p_{n-1}(t)\frac{dy}{dt}+p_n(t)y=g(t)\tag{2}$$
$(2)$ 定义的 $n$ 阶线性微分算子 $L$ 和第三章给出的二阶算子类似。$(2)$ 相关的数学理论和二阶线性微分方程类似，因此可以给出 $n$ 阶问题的结果。

由于 $(2)$ 涉及 $y$ 对 $t$ 的 $n$ 阶导，那么需要 $n$ 次积分来求解 $(2)$。每一次积分都会引入一个任意常数。因此如果指定了如下 $n$ 个初始条件，那么期望可以得到唯一解。
$$y(t_0)=y_0,y'(t_0)=y'_0,\cdots,y^{(n-1)}(t_0)=y^{(n-1)}_0\tag{3}$$
其中 $t_0$ 是区间 $I$ 上一点，且 $y_0,y'_0,\cdots,y^{(n-1)}_0$ 是给定实数常量。下面的定理与定理 3.2.1 类似，确保初值问题 $(2),(3)$ 有唯一解。

**定理 4.1.1**
> 如果函数 $p_1,p_2,\cdots,p_n,g$ 在开区间 $I$ 上连续，那么有且仅一个解 $y=\phi(t)$ 是微分方程 $(2)$ 的解且满足初始条件 $(3)$，其中 $t_0$ 是 $I$ 内任一点。这个解在 $I$ 上都存在。

这里不会给出证明。不过系数 $p_1,p_2,\cdots,p_n$ 是常数时，4.2 小节到 4.4 小节会讨论如何构造 $(2),(3)$ 的解，过程与第三章讨论的类似。如果没有定理 4.1.1，即使我们求得了一个解，也无法确定这个解是唯一解。

### 齐次方程
与二次问题类似，首先讨齐次方程。
$$L[y]=y^{(n)}+p_1(t)y^{(n-1)}+\cdots+p_{n-1}(t)y'+p_ny=0\tag{4}$$
如果函数 $y_1,y_2,\cdots,y_n$ 是微分方程 $(4)$ 的解，那么线性组合
$$y=c_1y_1(t)+c_2y_2(t)+\cdots+c_ny_n(t)\tag{5}$$
也是方程 $(4)$ 的解，其中 $c_1,c_2,\cdots,c_n$ 是任意常量。$(4)$ 的所有解都能表示成 $y_1,y_2,\cdots,y_n$ 的线性组合吗？不管 $(3)$ 如何，能够选择一组 $c_1,c_2,\cdots,c_n$ 满足初始条件，那么上面的问题是成立的。在 $I$ 上任意选择一点 $t_0$，任意选择 $y_0,y_0',\cdots,y^{(n-1)}_0$，必须能够确定 $c_1,c_2,\cdots,c_n$ 使得方程组
$$\begin{aligned}
c_1y_1(t_0)+c_2y_2(t_0)+c_ny_n(t_0)&=y_0\\
c_1y_1'(t_0)+c_2y_2'(t_0)+c_ny_n'(t_0)&=y_0'\\
\vdots\\
c_1y_1^{(n-1)}(t_0)+c_2y_2^{(n-1)}(t_0)+c_ny_n^{(n-1)}(t_0)&=y_0
\end{aligned}\tag{6}$$
成立。$n$ 个线性方程能够唯一确定 $n$ 个常量 $c_1,c_2,\cdots,c_n$ 的前提是系数行列式不为零。如果系数矩阵的行列式值是零，总是存在一种选择 $y_0,y_0',\cdots,y^{(n-1)}_0$ 是方程 $(6)$ 无解。对任意 $y_0,y_0',\cdots,y^{(n-1)}_0$ 方程 $(6)$ 有解的充要条件是朗斯基
$$W[y_1,y_2,\cdots,y_n]=\begin{vmatrix}
y_1&y_2&\cdots&y_n\\
y_1'&y_2'&\cdots&y_n'\\
\vdots&\vdots&&\vdots\\
y^{(n-1)}_1&y^{(n-1)}_2&\cdots&y^{(n-1)}_n
\end{vmatrix}\tag{7}$$
在 $t=t_0$ 时不为零。由于 $t_0$ 是 $I$ 上任意一点，因此充要条件是 $W[y_1,y_2,\cdots,y_n]$ 在 $I$ 上任一点处都不能为零。和二阶线性方程类似，如果 $y_1,y_2,\cdots,y_n$ 是方程 $(4)$ 的解，那么 $W[y_1,y_2,\cdots,y_n]$ 要么总是为零，要么总不为零。证明详见本节最后一个小节。因此可以得到如下定理。

**定理 4.1.2**
> 如果函数 $p_1,p_2,\cdots,p_n$ 在 $I$ 上连续，函数 $y_1,y_2,\cdots,y_n$ 是 $(4)$ 的解，在 $I$ 上有一点处有 $W[y_1,y_2,\cdots,y_n]\neq 0$，那么 $(4)$ 的每一个解都可以表达成解 $$y_1,y_2,\cdots,y_n$ 的线性组合。

方程 $(4)$ 的解 $y_1,y_2,\cdots,y_n$，其朗斯基不为零，那么构成了基础解系。$(5)$ 称为通解。

### 线性相关和线性无关
现在分析基础解系解的关系和线性无关的概念。如果在区间上 $I$ 上对于函数 $f_1,f_2,\cdots,f_n$，存在一组常量 $k_1,k_2,\cdots,k_n$ 均布为零，对于任意 $t\in I$ 都有
$$k_1f_1(t)+k_2f_2(t)+\cdots+k_nf_n(t)=0\tag{8}$$
那么这组函数是线性相关的（`linearly dependent`），否则这组函数是线性无关的（`linearly independent`）或线性独立的。

例 1 判断函数 $f_1(t)=1,f_2(t)=t,f_3(t)=t^2$ 是线性无关还是线性相关，对应区间是 $I:-\infty<t<\infty$。

解：线性组合是
$$k_1f_1(t)+k_2f_2(t)+k_3f_3(t)=k_1+k_2t+k_3t^2$$
令其为零
$$k_1+k_2t+k_3t^2=0\tag{9}$$
如果 $(9)$ 对任意 $t\in I$ 都成立，那么必须对 $I$ 内的三个点成立。任意不同的三个点都可以，这里选择 $t=0,t=1,t=-1$。将这三个点代入 $(9)$ 得到方程组
$$\begin{aligned}
k_1&&&=0\\
k_1&+k_2&+k_3&=0\\
k_1&-k_2&+k_3&=0
\end{aligned}\tag{10}$$
从第一个方程得到 $k_1=0$，接着从后续两个方程可以得到 $k_2=k_3=0$。因此不存在均不为零的集合 $k_1,k_2,k_3$ 使得 $(9)$ 成立。因此给定的三个函数在 $I$ 上是线性无关的。事实上，这三个函数在任意给定的区间上都是线性无关的。

例 2 确定函数
$$f_1(t)=1,f_2(t)=2+t,f_3(t)=3-t^2,f_4(t)=4t+t^2$$
在任意区间 $I$ 上是线性无关还是线性相关。

解：线性组合是
$$\begin{aligned}
k_1f_1(t)+k_2f_2(t)+k_3f_3(t)+k_4f_4(t)&=k_1+k_2(2+t)+k_3(3-t^2)+k_4(4t+t^2)\\
&=(k_1+2k_2+3k_3)+(k_2+4k_4)t+(-k_3+k_4)t^2
\end{aligned}\tag{11}$$
在整个区间上都为零，那么要求
$$k_1+2k_2+3k_3=0,k_2+4k_4=0,-k_3+k_4=0$$
三个方程，四个未知数，那么有无限多的解。比如如果 $k_4=1$，那么 $k_3=1,k_2=-4,k_1=5$。将这些系数代入 $(11)$ 得到这些函数的线性关系
$$5f_1(t)-4f_2(t)+f_3(t)+f_4(t)=0$$
因此这些函数在任意区间上都是线性相关的。

线性无关的概念可以用于描述齐次方程 $(4)$ 的基础解系的特征。假定函数 $y_1,y_2,\cdots,y_n$ 是方程 $(4)$ 在区间 $I$ 上的解，那么考虑方程
$$k_1y_1(t)+k_2y_2(t)+\cdots+k_ny_n(t)=0\tag{12}$$
对 $(12)$ 重复微分，得到另外 $n-1$ 个方程
$$\begin{aligned}
k_1y_1'(t)+k_2y_2'(t)+\cdots+k_ny_n'(t)&=0\\
&\vdots\\
k_1y_1^{(n-1)}(t)+k_2y_2^{(n-1)}(t)+\cdots+k_ny_n^{(n-1)}(t)&=0
\end{aligned}\tag{13}$$
方程 $(12),(13)$ 组成了一个 $n$ 个未知数 $k_1,k_2,\cdots,k_n$ $n$ 个线性方程的系统。这个系统的系数行列式是 $y_1,y_2,\cdots,y_n$ 的朗斯基 $W[y_1,y_2,\cdots,y_n]$。

**定理 4.1.3**
> 如果 $y_1(t),y_2(t),\cdots,y_n(t)$ 是 $n$ 阶线性微分方程 $(4)$
> $$L[y]=y^{(n)}+p_1(t)y^{(n-1)}+\cdots+p_{n-1}(t)y'+p_ny=0\tag{4}$$
> 在 $I$ 上的基础解系，那么 $y_1(t),y_2(t),\cdots,y_n(t)$ 在 $I$ 上是线性无关的。反之，如果 $y_1(t),y_2(t),\cdots,y_n(t)$ 在 $I$ 上是线性无关的，那么组成了基础解系。

下面证明这个定理。首先假设 $y_1(t),y_2(t),\cdots,y_n(t)$ 是微分方程 $(4)$ 的基础解系，那么对 $I$ 上任意 $t$ 都有朗斯基 $W[y_1,\cdots,y_n](t)\neq 0$。因此系统 $(12),(13)$ 对 $I$ 上所有 $t$ 都只有解 $k_1=\cdots=k_n=0$。因此 $y_1(t),y_2(t),\cdots,y_n(t)$ 在 $I$ 上是线性无关的。

现在证明另一面。假定 $y_1(t),y_2(t),\cdots,y_n(t)$ 在 $I$ 上线性无关。为了证明其是基础解系，需要证明朗斯基在 $I$ 不会为零。这里采用反证法。假定存在一点 $t_0$ 使得朗斯基为零。那么在该点处系统 $(12),(13)$ 有非零解，用 $k_1^*,k_2^*,\cdot,k_n^*$ 表示。那么可以得到线性组合
$$\phi(t)=k_1^*y_1(t)+\cdots+k_n^*y_n(t)\tag{14}$$
那么 $y=\phi(t)$ 满足初值问题
$$L[y]=0,y(t_0)=0,y'(t_0)=0,\cdots,y^{(n-1)}(t_0)=0\tag{15}$$
$\phi(t)$ 是解的线性组合，因此是微分方程的解，又因为它是 $(12),(13)$ 在 $t_0$ 时刻求值的方程，所以满足初值条件。不过函数 $y(t)=0,t\in I$ 也是这个初值问题的解，根据定理 4.1.1，初值问题 $(15)$ 的解是唯一的。因此 $\phi(t)=0,t\in I$。那么 $y_1(t),y_2(t),\cdots,y_n(t)$ 是线性相关的，这矛盾了。因此之前假设存在一点使得朗斯基为零是假命题。因此朗斯基在 $I$ 上不会为零。

注意一组函数 $f_1,f_2,\cdots,f_n$ 不是齐次线性微分方程 $(4)$ 的解，定理 4.1.3 不适用，即使在某些点甚至所有点处朗斯基为零，也可以是线性无关的。

### 非齐次方程
下面考虑非齐次方程 $(2)$
$$L[y]=y^{(n)}+p_1(t)y^{(n-1)}+\cdots+p_{n-1}(t)y'+p_ny=g(t)$$
如果 $Y_1,Y_2$ 是方程 $(2)$ 的两个解，由算子 $L$ 的线性性质可以得到
$$L[Y_1-Y_2](t)=L[Y_1](t)-L[Y_2](t)=g(t)-g(t)=0$$
因此非齐次方程的任意两个解的差是齐次方程 $(4)$ 的解。由于齐次方程的任意解可以表示为基础解系 $y_1,y_2,\cdots,y_n$ 的线性组合，那么非齐次方程 $(2)$ 的任意解可以写作
$$y=c_1y_1(t)+c_2y_2(t)+\cdots+c_ny_n(t)+Y(t)\tag{16}$$
其中 $Y$ 是非齐次微分方程 $(2)$ 的特解，$(16)$ 称为通解。

这里主要问题是确定 $n$ 阶齐次微分方程的基础解系 $\{y_1,y_2,\cdots,y_n\}$。如果系数是常亮，问题相对简单，后续小节会讨论。如果系数不是常量，需要使用第八章的数值法或者第五章的级数法。随着阶数增加问题越困难。

为了找到 $(16)$ 中的特解 $Y(t)$，待定系数法和参数变分法仍旧适用。下面两节会讨论这两个方法。

3.4 小节描述的降阶法对 $n$ 阶线性微分方程仍旧适用。如果 $y_1$ 是方程 $(4)$ 的一个解，那么将 $y=v(t)y_1(t)$ 代入得到一个 $v'$ 的 $n-1$ 阶微分方程。不过，如果 $n\geq 3$，降阶式子自身至少是二阶的，通常并不会简化原始问题。因此实践中降阶法很少用于高于二阶的微分方程。

### 推广定理 3.2.7
下面证明定理 3.2.7 适用于更高阶的微分方程。首先从三阶方程开始讨论。
$$y'''+p_1(t)y''+p_2(t)y'+p_3(t)y=0$$
令 $y_1,y_2,y_3$ 是方程在开区间 $I$ 上的解。

第一步，从对朗斯基
$$W[y_1,y_2,y_3]=\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
y_1''&y_2''&y_3''\\
\end{vmatrix}$$
开始微分开始。行列式的微分等于分别对每一行微分然后相加，那么
$$\begin{aligned}
W'&=\begin{vmatrix}
y_1'&y_2'&y_3'\\
y_1'&y_2'&y_3'\\
y_1''&y_2''&y_3''\\
\end{vmatrix}\\
&+\begin{vmatrix}
y_1&y_2&y_3\\
y_1''&y_2''&y_3''\\
y_1''&y_2''&y_3''\\
\end{vmatrix}\\
&+\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
y_1'''&y_2'''&y_3'''\\
\end{vmatrix}
\end{aligned}$$
前面两个行列式均有两行相同，因此行列式为零，那么
$$W'=\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
y_1'''&y_2'''&y_3'''\\
\end{vmatrix}$$
第二步，对上面的行列式进行一些不会影响行列式值的代数运算。包括以下几个步骤：（1）由于 $y_1,y_2,y_3$ 都是方程的解，因此将 $y'''$ 用 $y,y',y''$ 表示代入行列式；（2）第三行加上第一行乘以 $p_3$；（3）第三行加上第二行乘以 $p_2$；（4）最后一行提出公因子 $p_1$。
$$\begin{aligned}
W'&=\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
y_1'''&y_2'''&y_3'''\\
\end{vmatrix}\\
&=\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
-p_1y_1''-p_2y_1'-p_3y_1&-p_1y_2''-p_2y_2'-p_3y_2&-p_1y_3''-p_2y_3'-p_3y_3\\
\end{vmatrix}\\
&=\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
-p_1y_1''-p_2y_1'&-p_1y_2''-p_2y_2'&-p_1y_3''-p_2y_3'\\
\end{vmatrix}\\
&=\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
-p_1y_1''&-p_1y_2''&-p_1y_3''\\
\end{vmatrix}\\
&=-p_1(t)\begin{vmatrix}
y_1&y_2&y_3\\
y_1'&y_2'&y_3'\\
y_1''&y_2''&y_3''\\
\end{vmatrix}\\
&=-p_1(t)W
\end{aligned}$$
那么得到微分方程
$$W'=-p_1(t)W$$
第三步，这是一个可分离变量的微分方程，也是一个一节线性微分方程，不难得到通解
$$W=ce^{-\int p_1(t)dt}$$
从这个式子可以看出，朗斯基要么在 $I$ 上不为零，要么全部值都是零（此时 $c=0$）。

现在考虑 $n$ 阶微分方程
$$y^{(n)}+p_1(t)y^{(n-1)}+\cdots+p_n(t)y=0$$
上述过程的第一步，$W'$ 是 $n$ 个行列式的和，第 $i$ 个行列式对 $W$ 的第 $i$ 行微分，前 $n-1$ 个行列式有两行相同（这两行是第 $i,i+1$ 行），因此
$$W'=\begin{vmatrix}
y_1&y_2&\cdots&y_n\\
y_1'&y_2'&\cdots&y_n'\\
y_1''&y_2''&\cdots&y_n''\\
&&\vdots\\
y_1^{(n)}&y_2^{(n)}&\cdots&y_n^{(n)}\\
\end{vmatrix}$$
上述过程的第二步，进行一些行列式的运算。第一个步骤不变，代入 $y^{(n)}$，第二步和第三步变成了 $n-1$ 次迭代，第 $i$ 迭代是第 $i$ 行乘以 $p_{n+1-i}$ 加到最后一行以消除多项式的一项。最后一个步骤也不变。因此得到相同的微分方程
$$W'=-p_1(t)W$$
第三步完全一致。至此可以得到
$$W=ce^{-\int p_1(t)dt}$$
