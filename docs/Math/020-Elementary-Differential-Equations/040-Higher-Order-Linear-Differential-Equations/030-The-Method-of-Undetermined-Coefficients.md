如果常系数非齐次 $n$ 阶线性微分方程
$$L[y]=a_0y^{(n)}+a_1y^{(n-1)}+\cdots+a_{n-1}y'+a_ny=g(t)\tag{1}$$
的非齐次项 $g(t)$ 是某种合适的形式，那么可以利用待定系数法求解特解 $Y$。虽然这种方法不如参数变分法通用，但是更简单。

和之前讨论的二阶线性微分方程类似，当常系数线性微分算子 $L$ 用于多项式 $A_0t^m+A_1t^{m-1}+\cdots+A_m$、指数函数 $e^{\alpha t}$、正弦函数和余弦函数的线性组合 $a_1\cos\beta t+a_2\sin\beta t$，结果还是多项式、指数函数、正弦和余弦的线性组合。因此如果 $g(t)$ 是这些函数的和或者积，那么 $Y(t)$ 是这些函数的组合再乘以待定系数的形式。将 $Y$ 代回方程 $(1)$ 可以确定待定系数。

对于高阶方程使用这个方法的主要差异是特征方程的重复根的次数可能会大于 2。因此，非齐次项对应的特解可能需要乘以 $t$ 的更高次幂使之与对应的齐次方程的通解不同。下面的例子会阐述这一点。这些例子忽略了冗长但直接的代数运算，这里的主要目的是讨论如何找到特解的正确形式。

例 1 求
$$y'''-3y''+3y'-y=4e^t\tag{2}$$
的通解。

解：方程 $(2)$ 对应的齐次方程的特征方程是
$$r^3-3r^2+3r-1=(r-1)^3=0$$
因此齐次方程的通解是
$$y_c(t)=c_1e^t+c_2te^t+c_3t^2e^t\tag{3}$$
假定 $Y(t)=Ae^t$，但是 $e^t,te^t,t^2e^t$ 是齐次方程的解，因此我们不得不乘以 $t^3$ 来区别，那么 $Y(t)=At^3e^t$，其中 $A$ 是待定系数。

对 $Y(t)$ 求导并代回方程 $(2)$ 得到
$$6Ae^=4e^t$$
因此 $A=\frac{2}{3}$，那么特解是
$$Y(t)=\frac{2}{3}t^3e^t\tag{4}$$
因此方程 $(2)$ 的通解是
$$y=c_1e^t+c_2te^t+c_3t^2e^t+\frac{2}{3}t^3e^t$$

例 2 求
$$y^{(4)}+2y'+y=3\sin t-5\cos t\tag{5}$$
的特解。

解：4.2 小节的例 3 已经得到其对应的齐次方程的通解是
$$y_c(t)=c_1\cos t+c_2\sin t+c_3t\cos t+c_4t\sin t\tag{6}$$
特征方程的根是 $r=i,i,-i,-i$。假定特解形式是 $Y(t)=A\sin t+B\cos t$，但是这里不得不乘以 $t^2$ 使之与通解区分开来，因此特解形式是
$$Y(t)=At^2\sin t+Bt^2\cos t$$
求四次导，代入方程 $(5)$ 得到
$$-8A\sin t-8B\cos t=3\sin t-5\cos t$$
因此 $A=-\frac{3}{8},B=\frac{5}{8}$，方程 $(5)$ 的特解是
$$Y(t)=-\frac{3}{8}t^2\sin t+\frac{5}{8}t^2\cos t\tag{7}$$

如果 $g(t)$ 是若干项之和，分别求特解然后相加，这和二阶线性方程是一样的。

例 3 求
$$y'''-4y'=t+3\cos t+e^{-2t}\tag{8}$$
的特解。

解：齐次方程的特征方程是 $r^3-4r=0$，根是 $r=0,\pm 2$，那么
$$y_c(t)=c_1+c_2e^{2t}+c_3e^{-2t}$$
方程 $(8)$ 的特解是下面三个微分方程的特解之和。
$$y'''-4y'=t$$
$$y'''-4y'=3\cos t$$
$$y'''-4y'=e^{-2t}$$
第一个方程对应的特解形式是 $Y_1(t)=A_0t+A_1$，不过常量是齐次方程解的一部分，因此需要乘以 $t$，那么
$$Y_1(t)=t(A_0t+A_1)$$
第二个方程对应的特解形式是
$$Y_2(t)=B\cos t+C\sin t$$
齐次方程的解不包含正弦和余弦函数，因此无需乘以 $t$ 的若干次幂。最后是第三个方程，由于 $e^{-2t}$ 是齐次方程解的一部分，那么需要乘以 $t$ 得到
$$Y_3(t)=Ete^{-2t}$$
求导代入方程得到常量 $A_0=-\frac{1}{8},A_1=0,B=0,C=-\frac{3}{5},E=\frac{1}{8}$。因此方程 $(8)$ 的特解是
$$Y(t)=-\frac{1}{8}t^2-\frac{3}{5}\sin t+\frac{1}{8}te^{-2t}\tag{9}$$
对于高阶方程，计算系数的运算量很大，特别是非齐次项复杂的时候。计算机代数系统非常有用。

### 零化子法
这是一种得到待定系数特解形式的方法。

对于指数函数、多项式和正弦余弦非齐次项，零化子（`annihilator`）法是将其看作某个常系数线性齐次微分方程的解。比如 $e^{-t}$ 是 $(D+1)y=0$ 的解，其中 $D=\frac{d}{dt}$，这里 $(D+1)$ 是 $e^{-t}$ 的零化子。$(D^2+4)$ 是 $\sin 2t$ 或 $\cos 2t$ 的零化子，$(D-3)^2=D^2-6D+9$ 是 $e^{3t},te^{3t}$ 的零化子。

零化子满足交换律。令 $f$ 是可以二阶导的函数，那么
$$\begin{aligned}
(D-a)(D-b)f&=(D-a)(\frac{df}{dt}-bf)\\
&=\frac{d^2f}{dt^2}-b\frac{df}{dt}-a\frac{df}{dt}+abf\\
&=(D-b)(\frac{df}{dt}-af)\\
&=(D-b)(D-a)f
\end{aligned}$$
下面先看一个具体例子。求
$$(D-2)^3(D+1)Y=3e^{2t}-te^{-t}\tag{10}$$
的特解 $Y(t)$。

$3e^{2t}$ 的零化子是 $D-2$，因为
$$(D-2)3e^{2t}=6e^{2t}-6e^{2t}=0$$
$-te^{-t}$ 的零化子是 $(D+1)^2$，因为
$$\begin{aligned}
(D+1)^2(-te^{-t})&=(D+1)(-e^{-t}+te^{-t}-te^{-t})\\
&=(D+1)(-e^{-t})\\
&=e^{-t}-e^{-t}\\
&=0
\end{aligned}$$
那么 $3e^{2t}-te^{-t}$ 的零化子是 $(D-2)(D+1)^2$。$(D+1)$ 是 $-te^{-t}$ 的零化子，作用于 $3e^{2t}$ 的结果是 $27e^{2t}$，$(D-2)27e^{2t}=0$。

方程 $(10)$ 两边应用算子 $(D-2)(D+1)^2$，使用交换律得到
$$(D-2)^4(D+1)^3Y=0\tag{11}$$
那么解是
$$Y(t)=c_1e^{2t}+c_2te^{2t}+c_3t^2e^{2t}+c_4t^3e^{2t}+c_5e^{-t}+c_6te^{-t}+c_7t^2e^{-t}\tag{12}$$
原始方程 $(10)$ 的齐次方程的解有 $e^{2t},te^{2t},t^2e^{2t},e^{-t}$，那么 $c_1,c_2,c_3,c_5$ 对非齐次方程没用，令它们为零，那么特解是
$$Y(t)=c_4t^3e^{2t}+c_6te^{-t}+c_7t^2e^{-t}\tag{13}$$
代入 $(10)$ 得到系数。

下面总结上述过程。对于非齐次方程
$$L(D)y=g(t)\tag{14}$$
其中 $L(D)$ 是常系数线性微分算子，$g(t)$ 是指数函数、多项式、正弦余弦的积。为了找到 $(14)$ 的特解，步骤如下：

1. 求 $g(t)$ 的零化子 $H(D)$，即 $H(D)g(t)=0$。
2. 对 $(14)$ 应用 $H(D)$，得到更高阶的微分方程 $H(D)L(D)y=0$。
3. 求解第二步得到的方程。
4. 令 $L(D)y=0$ 的解对应的 $c$ 为零，得到 $(14)$ 的特解形式。
