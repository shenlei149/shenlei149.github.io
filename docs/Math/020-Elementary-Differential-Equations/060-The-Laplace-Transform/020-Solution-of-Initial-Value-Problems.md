这一节讨论如何使用拉普拉斯变换来求解常系数微分方程的初值问题。拉普拉斯变换在这里有效的主要原因是 $f$ 和 $f'$ 的变换的关系非常简单。

**定理 6.2.1**
> 假定在区间 $0\leq t\leq A$ 上 $f$ 是连续的 $f'$ 是分段连续的，并且假定存在常量 $K,a,M$ 使得 $|f(t)|\leq Ke^{at},t\geq M$，那么 $\mathcal{L}\{f'\}$ 在 $s>a$ 上存在并且
> $$\mathcal{L}\{f'(t)\}=s\mathcal{L}\{f(t)\}-f(0)\tag{1}$$

为了证明这个定理，考虑积分
$$\int_0^Ae^{-st}f'(t)dt$$
在 $A\to\infty$ 时的极限，如果其存在，那么就是 $f'$ 的拉普拉斯变换。我们用 $t_1,t_2,\cdots,t_k$ 表示 $f'$ 在区间 $0\leq t\leq A$ 上的不连续点，那么积分可以写作
$$\int_0^Ae^{-st}f'(t)dt=\int_0^{t_1}e^{-st}f'(t)dt+\int_{t_1}^{t_2}e^{-st}f'(t)dt+\cdots+\int_{t_k}^Ae^{-st}f'(t)dt$$
每一项使用分部积分法得到
$$\begin{aligned}
\int_0^Ae^{-st}f'(t)dt=&e^{-st}f(t)|_0^{t_1}+e^{-st}f(t)|_{t_1}^{t_2}+\cdots+e^{-st}f(t)|_{t_k}^{A}\\
&+s\bigg[\int_0^{t_1}e^{-st}f(t)dt+\int_{t_1}^{t_2}e^{-st}f(t)dt+\cdots+\int_{t_k}^Ae^{-st}f(t)dt\bigg]
\end{aligned}$$
由于 $f$ 是连续的，那么连续的积分项可以合并。于是乎有
$$\int_0^Ae^{-st}f'(t)dt=e^{-sA}-f(0)+s\int_0^Ae^{-st}f(t)dt\tag{2}$$
令 $t\to\infty$，上式右边的积分就是 $\mathcal{L}\{f(t)\}$。对于 $A\geq M$，有 $|f(A)|\leq Ke^{at}$，那么 $|e^{-sA}f(A)|\leq Ke^{-(s-a)A}$。因此当 $A\to\infty$ 时，$e^{-sA}f(A)\to 0, s>a$。因此 $(2)$ 的右边第一项为零，结果是 $s\mathcal{L}\{f(t)\}-f(0)$。左边的极限是 $\mathcal{L}\{f'(t)\},s>a$。因此 $s>a$ 时有
$$\mathcal{L}\{f'(t)\}=s\mathcal{L}\{f(t)\}-f(0)$$
如果 $f',f''$ 满足定理 6.2.1 中 $f,f'$ 的条件，那么 $f''$ 拉普拉斯变换存在，并且
$$\begin{aligned}
\mathcal{L}\{f''(t)\}&=s\mathcal{L}\{f'(t)\}-f'(0)\\
&=s(s\mathcal{L}\{f(t)\}-f(0))-f'(0)\\
&=s^2\mathcal{L}\{f(t)\}-sf(0)-f'(0)
\end{aligned}\tag{3}$$
这个推导一直可以继续下去得到如下推论。

**推论 6.2.2**
> 假定在区间 $0\leq t\leq A$ 函数 $f,f',\cdots,f^{(n-1)}$ 是连续的并且 $f^{(n)}$ 分段连续，并且假定存在常量 $K,a,M$ 使得 $|f(t)|\leq Ke^{at},|f'(t)|\leq Ke^{at},\cdots,|f^{(n-1)}(t)|\leq Ke^{at}$，那么 $\mathcal{L}\{f^{(n)}(t)\},s>a$ 存在并且
> $$\mathcal{L}\{f^{(n)}(t)\}=s^n\mathcal{L}\{f(t)\}-s^{n-1}f(0)\cdots-sf^{(n-2)}(0)-f^{(n-1)}(0)\tag{4}$$

下面讨论如何使用拉普拉斯变换解决齐次微分方程的初值问题，本章稍后讨论非齐次的情况。

例 1 求满足初始条件
$$y(0)=1,y'(0)=0\tag{6}$$
的微分方程
$$y''-y'-2y=0\tag{5}$$
解：根据 3.1 小节的方法也能轻松求解这个问题。特征方程是
$$r^2-r-2=(r-2)(r+1)=0$$
那么 $(5)$ 的通解是
$$y=c_1e^{-t}+c_2e^{2t}\tag{7}$$
代入初始条件 $(6)$ 得到 $c_1+c_2=1，-c_1+2c_2=0$，那么 $c_1=\frac{2}{3},c_2=\frac{1}{3}$，因此初值问题 $(5),(6)$ 的解是
$$y=\frac{2}{3}e^{-t}+\frac{1}{3}e^{2t}\tag{8}$$
下面使用拉普拉斯变换求解。假定解是 $y=y(t)$，并且前两阶导数满足推论 6.2.2，那么对 $(5)$ 求拉普拉斯变换
$$\mathcal{L}\{y''-y'-2y\}=\mathcal{L}\{y''\}-\mathcal{L}\{y'\}-2\mathcal{L}\{y\}=0\tag{9}$$
这里使用了拉普拉斯变换是线性算子的性质。应用推论使用 $\mathcal{L}\{y\}$ 表示 $\mathcal{L}\{y''\},\mathcal{L}\{y'\}$，那么 $(9)$ 是
$$s^2\mathcal{L}\{y\}-sy(0)-y'(0)-s\mathcal{L}\{y\}+y(0)-2\mathcal{L}\{y\}=0$$
那么
$$(s^2-s-2)Y(s)+(1-s)y(0)-y'(0)=0\tag{10}$$
其中 $\mathcal{L}\{y\}=Y(s)$。代入初始条件 $y(0),y'(0)$ 得到
$$Y(s)=\frac{s-1}{s^2-s-2}=\frac{s-1}{(s-2)(s+1)}\tag{11}$$
现在需要找到 $y(t)$，其拉普拉斯变换是 $Y(s)$。对右边使用部分分式，得到
$$Y(s)=\frac{s-1}{(s-2)(s+1)}=\frac{a}{s-2}+\frac{b}{s+1}=\frac{a(s+1)+b(s-2)}{(s-1)(s+1)}\tag{12}$$
其中 $a,b$ 是待定系数。根据分子相等得到
$$s-1=a(s+1)+b(s-2)$$
对所有 $s$ 都成立。令 $s=2$ 得到 $a=\frac{1}{3}$。令 $s=-1$ 得到 $b=\frac{2}{3}$，那么
$$Y(s)=\frac{1/3}{s-2}+\frac{2/3}{s+1}\tag{13}$$
使用上一节的例子，这两项分别是 $\frac{1}{3}e^{2t},\frac{2}{3}e^{-t}$ 的拉普拉斯变换，因此
$$y(t)=\frac{2}{3}e^{-t}+\frac{1}{3}e^{2t}$$
这个函数确实满足推论 6.2.2 的假设。当然，结果也和前面使用 3.1 小节的方法得到的结果一致。

同样的方法可以应用于更通用的常系数二阶线性方程
$$ay''+by'+cy=f(t)\tag{14}$$
假定 $y(t)$ 满足推论 6.2.2 $n=2$ 时的条件，对 $(14)$ 进行拉普拉斯变换得到
$$a(s^2Y(s)-sy(0)-y'(0))+b(sY(s)-y(0))+cY(s)=F(s)\tag{15}$$
其中 $F(s)$ 是 $f(t)$ 的拉普拉斯变换。那么
$$Y(s)=\frac{(as+b)y(0)+ay'(0)}{as^2+bs+c}+\frac{F(s)}{as^2+bs+c}\tag{16}$$
如果能求解 $y(t)$，其拉普拉斯变换是 $Y(s)$，那么问题就解决了。

拉普拉斯变换法求解微分方程有几个特征。首先求解 $Y(s)$ 是解代数方程 $(15)$ 而不是微分方程 $(14)$，这是拉普拉斯变换求微分方程的关键。齐次，过程中会自动找到满足初始条件的解，而无需确定通解中的任意常量。根据 $(15)$，求解非齐次方程和处理齐次方程式一样的，无需先求齐次方程的通解。最后，只要假定解满足推论 6.2.2 的条件，那么求解高阶微分方程的步骤完全一致。

$(16)$ 分母中的多项式 $as^2+bs+c$ 是微分方程 $(14)$ 的特征方程。因为需要对 $Y(s)$ 使用部分分式来确定 $y(t)$，因此需要分解这个多项式，所以拉普拉斯变换法不能避免求解特征方程的根。对于高阶微分方程，或许需要数值计算，特别是根是无理数或复数。

使用拉普拉斯变换求解初值问题的关键点在于求变换 $Y(s)$ 对应的 $y(t)$。这个过程称为求拉普拉斯逆变换（`inverse Laplace transform`）。通常使用 $\mathcal{L}^{-1}\{Y(s)\}$ 表示 $Y(s)$ 的逆变换。对逆变换有通用公式，不过设计复变函数，因此这里不考虑通用公式。即便不使用复变函数，仍旧可以推导很多拉普拉斯变换的属性，以及求解很多问题。

在求解初值问题 $(5),(6)$ 时，我们并没有考虑除了 $(8)$ 之外还有没有变换是 $(13)$ 的函数。根据定理 3.2.1，初值问题有唯一解。唯一解 $(8)$ 是连续的。与这些事实一致，可以证明如果 $f,g$ 是连续函数，其拉普拉斯变换一样，那么 $f,g$ 是一样的。如果 $f,g$ 是分段连续的，那么有一个或多个非连续点处的值不同，但是其拉普拉斯变换是一样的。分段连续函数的拉普拉斯逆变换没有唯一性在实际应用中并没有意义。

本质上函数及其拉普拉斯变换存在一对一的关系。这就可以编一个表，比如下表，来列出函数及其拉普拉斯变换。第一列是函数，第二列是拉普拉斯变换。更重要的方向是第一列是第二列的拉普拉斯逆变换。如果知道微分方程解的变换，查表可以得到逆变换，这就找到了解。计算机代数软件也能轻松得到拉普拉斯变换和逆变换。

| $f(t)=\mathcal{L}^{-1}\{F(s)\}$ | $F(s)=\mathcal{L}\{f(t)\}$ |
|--|--|
| $1$ | $\frac{1}{s},s>0$ |
| $e^{at}$ | $\frac{1}{s-a},s>a$ |
| $t^n$ | $\frac{n!}{s^{n+1}},s>0$ |
| $t^p,p>-1$ | $\frac{\Gamma(p+1)}{s^{p+1}},s>0$ |
| $\sin at$ | $\frac{a}{s^2+a^2},s>0$ |
| $\cos at$ | $\frac{s}{s^2+a^2},s>0$ |
| $\sinh at$ | $\frac{a}{s^2-a^2},s>\|a\|$ |
| $\cosh at$ | $\frac{s}{s^2-a^2},s>\|a\|$ |
| $e^{at}\sin bt$ | $\frac{b}{(s-a)^2+b^2},s>a$ |
| $e^{at}\cos bt$ | $\frac{s-a}{(s-a)^2+b^2},s>a$ |
| $t^ne^{at}$ | $\frac{n!}{(s-a)^{n+1}},s>a$ |
| $u_c(t)\begin{cases}0&&t<c\\1&&t\geq c\end{cases}$ | $\frac{e^{-sc}}{s},s>0$ |
| $u_c(t)f(t-c)$ | $e^{-cs}F(s)$ |
| $e^{ct}f(t)$ | $F(s-c)$ |
| $f(ct)$ | $\frac{1}{c}F(\frac{s}{c}),c>0$ |
| $(f * g)(t)=\int_0^t f(t-\tau)g(\tau)d\tau$ | $F(s)G(s)$ |
| $\delta(t-c)$ | $e^{-cs}$ |
| $f^{(n)}(t)$ | $s^n\mathcal{L}\{f(t)\}-s^{n-1}f(0)\cdots-sf^{(n-2)}(0)-f^{(n-1)}(0)$ |
| $(-t)^nf(t)$ | $F^{(n)}(s)$ |

如果拉普拉斯变换 $F(s)$ 可以写作多项之和
$$F(s)=F_1(s)+F_2(s)+\cdots+F_n(s)\tag
{17}$$
假设 $f_1(t)=\mathcal{L}^{-1}\{F_1(s)\},\cdots,f_n(t)=\mathcal{L}^{-1}\{F_n(s)\}$，那么函数
$$f(t)=f_1(t)+f_2(t)+\cdots+f_n(t)$$
的拉普拉斯变换是 $F(s)$。根据唯一性，没有其他连续函数 $f$ 有相同的变换，因此
$$\mathcal{L}^{-1}\{F(s)\}=\mathcal{L}^{-1}\{F_1(s)\}+\cdots+\mathcal{L}^{-1}\{F_n(s)\}\tag{18}$$
因此拉普拉斯逆变换也是线性算子。

根据线性属性可以将一个函数分解成若干个已知逆变换的函数之和，然后求解。部分分式法很有用。本章后续还会讨论拉普拉斯变换的属性。

例 2 求满足初始条件
$$y(0)=2,y'(0)=1\tag{20}$$
的微分方程
$$y''+y=\sin 2t\tag{19}$$
的解。

解：假定解是 $y(t)$，一阶导和二阶导满足推论 6.2.2 的条件。对微分方程进行拉普拉斯变换，那么
$$s^2Y(s)-sy(0)-y'(0)+Y(s)=\frac{2}{s^2+4}$$
代入初始条件得到
$$Y(s)=\frac{2s^3+s^2+8s+6}{(s^2+1)(s^2+4)}\tag{21}$$
使用部分分式法分解得到
$$Y(s)=\frac{as+b}{s^2+1}+\frac{cs+d}{s^2+4}=\frac{(as+b)(s^2+4)+(cs+d)(s^2+1)}{(s^2+1)(s^2+4)}\tag{22}$$
对所有 $s$ $(21),(22)$ 的分子都相等，即
$$2s^3+s^2+8s+6=(as+b)(s^2+4)+(cs+d)(s^2+1)\tag{23}$$
计算 $s$ 的系数有
$$a+c=2,b+d=1,4a+c=8,4b+d=6$$
那么
$$a=2,c=0,b=\frac{5}{3},d=-\frac{2}{3}$$
因此
$$Y(s)=\frac{2s}{s^2+1}+\frac{5/3}{s^2+1}-\frac{2/3}{s^2+4}$$
查表可知
$$y(t)=2\cos t+\frac{5}{3}\sin t-\frac{1}{3}\sin 2t\tag{25}$$

例 3 求解初值问题
$$y^{(4)}-y=0\tag{26}$$
$$y(0)=0,y'(0)=1,y''(0)=0,y'''(0)=0\tag{27}$$
解：假定解是 $y(t)$ 并且前四阶导满足推论 6.2.2 的条件。对微分方程进行拉普拉斯变换得到
$$s^4Y(s)-s^3y(0)-s^2y'(0)-sy''(0)-y'''(0)-Y(s)=0$$
代入初始条件
$$Y(s)=\frac{s^2}{s^4-1}\tag{28}$$
部分分式
$$Y(s)=\frac{as+b}{s^2-1}+\frac{cs+d}{s^2+1}\tag{29}$$
那么
$$(as+b)(s^2+1)+(cs+d)(s^2-1)=s^2\tag{30}$$
对所有 $s$ 都成立。首先代入 $s=1,s=-1$ 可以得到
$$2(a+b)=1,2(-a+b)=1$$
那么
$$a=0,b=\frac{1}{2}$$
将 $s=0$ 代入 $(30)$ 那么 $b-d=0$，因此 $d=\frac{1}{2}$。最后，$s^3$ 的系数相等，那么 $a+c=0$，因此 $c=0$。因此
$$Y(s)=\frac{1/2}{s^2-1}+\frac{1/2}{s^2+1}\tag{31}$$
查表可以得到
$$y(t)=\frac{1}{2}(\sinh t+\sin t)\tag{32}$$
我们本可以使用如下部分分式
$$Y(s)=\frac{a}{s-1}+\frac{b}{s+1}+\frac{cs+d}{s^2+1}$$
来求解，但是并没有这么做。原因是前面给出的拉普拉斯变换表中包含 $1/(s^2\pm 1),s/(s^2\pm 1)$ 的变换。
