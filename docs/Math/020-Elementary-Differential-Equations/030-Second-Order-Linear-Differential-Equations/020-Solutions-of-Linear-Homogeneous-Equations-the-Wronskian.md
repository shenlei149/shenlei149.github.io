前一节我们解决了形如
$$ay''+by'+cy=0$$
其中 $a,b,c$ 是常数的微分方程。下面讨论二阶齐次线性微分方程的解的结构。这有助于我们找到稍后会遇到的其他问题的解。

引入微分算子（`differential operator`）有助于讨论线性微分方程的一般属性。假定 $p,q$ 在区间 $I,\alpha<t<\beta$ 上连续，$\alpha,\beta$ 可以是无穷。在 $I$ 上函数 $\phi$ 二阶可微，那么微分算子 $L$ 的定义是
$$L[\phi]=\phi''+p\phi'+q\phi\tag{1}$$
比如 $p(t)=t^2,q(t)=1+t,\phi(t)=\sin 3t$，那么
$$\begin{aligned}
L[\phi(t)]&=(\sin 3t)''+(t^2)(\sin 3t)'+(1+t)(\sin 3t)\\
&=-9\sin 3t+3t^2\cos 3t+(1+t)\sin 3t
\end{aligned}$$
算子 $L$ 也经常写作 $L=D^2+pD+q$，其中 $D$ 是微分算子，$D[\phi]=\phi'$。

这一节我们分析二阶线性齐次微分微分方程，即 $L[\phi](t)=0$。由于我们可以使用 $y$ 替代 $\phi(t)$，所以方程也通常写作
$$L[y]=y''+p(t)y'+q(t)y=0\tag{2}$$
再给出一组初始条件
$$y(t_0)=y_0,y'(t_0)=y_0'\tag{3}$$
其中 $t_0$ 是 $I$ 上一点，$y_0,y_0'$ 是给定实数。我们想知道初值问题 $(2),(3)$ 是否有解，有一个解还是多个解。我们还想知道解的形式和结构是否有助于找到特定问题的解。本节的定理将会回答这些问题。

定理 3.2.1 给出了二阶线性微分方程的初值问题的基本理论，与定理 2.4.1 类似。该定理对非齐次微分方程也适用，因此定理是非齐次形式。

**定理 3.2.1 存在性与唯一性（Existence and Uniqueness Theorem）**
> 考虑初值问题
> $$y''+p(t)y'+q(t)y=g(t),y(t_0)=y_0,y'(t_0)=y_0'\tag{4}$$
> 其中 $p,q,g$ 在包含 $t_0$ 的区间 $I$ 上连续。那么这个问题只有一个解 $y=\phi(t)$，且这个解在整个 $I$ 上都存在。

这个定理说了三件事：

1. 初值问题有解，即解存在
2. 初值问题只有一个解，即解是唯一的
3. 解 $\phi$ 在整个 $I$ 上都存在，系数连续且存在二阶导

对于一些问题，其中一些论断比较容易证明。比如 3.1 小节中例 1 的初值问题就有一个解。
$$y''-y=0,y(0)=2,y'(0)=-1\tag{5}$$
的解是
$$y=\frac{1}{2}e^t+\frac{3}{2}e^{-t}\tag{6}$$
首先，可以确认这就是解，且解有二阶导，准确的说有任意阶导数，且在区间 $(-\infty,\infty)$ 上都有定义。不过证明 $(5)$ 没有 $(6)$ 之外的解就比较困难了。定理 3.2.1 表明只有这一个解。

对于问题 $(4)$，不太容易表达出解。这是一阶和二阶线性微分方程的主要差异。因此定理的证明与这样的表达式无关。事实上，证明定理 3.2.1 相当困难，这里就不再讨论。

例 1 求初值问题
$$(t^2-3t)y''+ty'-(t+3)y=0,y(1)=2,y'(1)=1$$
解存在的最长区间。

解：将微分方程写成 $(4)$ 的形式，那么
$$p(t)=\frac{1}{t-3},q(t)=-\frac{t+3}{t(t-3)},g(t)=0$$
系数不连续的点是 $t=0,t=3$。因此包含 $t=1$、所有系数是连续的最大区间是 $0<t<3$。定理 3.2.1 保证在这个区间上解存在。

例 2 求初值问题
$$y''+p(t)y'+q(t)y=0,y(t_0)=0,y'(t_0)=0$$
的唯一解，其中 $p,q$ 在包含 $t_0$ 的区间 $I$ 上连续。

解：函数 $y=\phi(t)=0$ 在 $I$ 上对任意 $t$ 都满足微分方程和初始条件。定理 3.2.1 的唯一性保证了这就是初值问题唯一的解。

假定 $y_1,y_2$ 是方程 $(2)$ 的两个解，即
$$L[y_1]=y_1''+py_1'+qy_1=0$$
$$L[y_2]=y_2''+py_2'+qy_2=0$$
类似 3.1 小节，通过对 $y_1,y_2$ 进行线性组合可以得到更多的解。

**定理 3.2.2 叠加原理（Principle of Superposition）**
> 如果 $y_1,y_2$ 是微分方程 $(2)$ 的两个解
> $$L[y]=y''+p(t)y'+q(t)y=0$$
> 那么 $y_1,y_2$ 的线性组合 $c_1y_1+c_2y_2$ 也是微分方程的解，其中 $c_1,c_2$ 是任意常量。

我们将
$$y=c_1y_1+c_2y_2\tag{7}$$
代入微分方程 $(2)$
$$\begin{aligned}
L[c_1y_1+c_2y_2]&=(c_1y_1+c_2y_2)''+p(c_1y_1+c_2y_2)'+q(c_1y_1+c_2y_2)\\
&=c_1y_1''+c_2y_2''+pc_1y_1'+pc_2y_2'+qc_1y_1+qc_2y_2\\
&=c_1(y_1''+py_1'+qy_1)+c_2(y_2''+py_2'+qy_2)\\
&=c_1L[y_1]+c_2L[y_2]
\end{aligned}$$
由于 $L[y_1]=0,L[y_2]=0$，那么 $L[c_1y_1+c_2y_2]=0$。因此不管 $c_1,c_2$ 选择什么值，$(7)$ 是 $(2)$ 的解。

定理 3.2.2 是说如果我们能够找到 $(2)$ 的两个解，那么可以利用 $(7)$ 构造出无穷多个解。下一个问题是 $(7)$ 是否包含了 $(2)$ 所有的解，还是说存在一些其他形式的解。我们从如何选择 $c_1,c_2$ 满足初始条件入手，将 $(7)$ 代入初始条件得到
$$\begin{aligned}
c_1y_1(t_0)+c_2y_2(t_0)&=y_0\\
c_1y_1'(t_0)+c_2y_2'(t_0)&=y_0'
\end{aligned}\tag{8}$$
$(8)$ 的系数行列式是
$$W=\begin{vmatrix}
y_1(t_0)&y_2(t_0)\\
y_1'(t_0)&y_2'(t_0)
\end{vmatrix}=y_1(t_0)y_2'(t_0)-y_1'(t_0)y_2(t_0)\tag{9}$$
如果 $W\neq 0$，那么给定 $y_0,y_0'$ $(8)$ 有唯一解 $(c_1,c_2)$。
$$c_1=\frac{y_0y_2'(t_0)-y_0'y_2(t_0)}{y_1(t_0)y_2'(t_0)-y_1'(t_0)y_2(t_0)},c_2=\frac{-y_0y_1'(t_0)+y_0'y_1(t_0)}{y_1(t_0)y_2'(t_0)-y_1'(t_0)y_2(t_0)}\tag{10}$$
使用行列式表达是
$$c_1=\frac{\begin{vmatrix}
y_0&y_2(t_0)\\
y_0'&y_2'(t_0)
\end{vmatrix}}{\begin{vmatrix}
y_1(t_0)&y_2(t_0)\\
y_1'(t_0)&y_2'(t_0)
\end{vmatrix}},c_2=\frac{\begin{vmatrix}
y_1(t_0)&y_0\\
y_1'(t_0)&y_0'
\end{vmatrix}}{\begin{vmatrix}
y_1(t_0)&y_2(t_0)\\
y_1'(t_0)&y_2'(t_0)
\end{vmatrix}}\tag{11}$$
当 $c_1,c_2$ 选择这些值的时候，线性组合 $y=c_1y_1(t)+c_2y_2(t)$ 满足初始条件 $(3)$ 和微分方程 $(2)$。注意 $c_1,c_2$ 的表达式的分母 $W$ 不为零。

另一方面，如果 $W=0$，那么 $(10),(11)$ 的分母为零。这种情况下，除非 $y_0,y_0'$ 能够使得 $(10),(11)$ 分子也为零，否则 $(8)$ 没有解。因此如果 $W=0$，不管 $c_1,c_2$ 如何选择，初始条件都无法被满足。

行列式 $W$ 称为解 $y_1,y_2$ 的朗斯基行列式（`Wronskian determinant`）或简称为朗斯基（`Wronskian`）。有时我们用 $W[y_1,y_2](t_0)$ 表示 $(9)$ 的右边，这是为了强调朗斯基行列式依赖于函数 $y_1,y_2$，在 $t_0$ 点出求值。

**定理 3.2.3**
> 假定 $y_1,y_2$ 是方程 $(2)$ 的两个解
> $$L[y]=y''+p(t)y'+q(t)y=0$$
> 并且给定了初始条件 $(3)$
> $$y(t_0)=y_0,y'(t_0)=y_0'$$
> 那么总是能够选择常量 $c_1,c_2$ 使得
> $$y=c_1y_1(t)+c_2y_2(t)$$
> 满足微分方程 $(2)$ 和初始条件 $(3)$ 等价于朗斯基
> $$W[y_1,y_2](t_0)=y_1y_2'-y_1'y_2$$
> 在 $t_0$ 处不等于零。

例 3 在 3.1 小节的例 2 中，我们求得了微分方程
$$y''+5y'+6y=0$$
的两个解 $y_1=e^{-2t},y_2=e^{-3t}$。求 $y_1,y_2$ 的朗斯基行列式。

解：这两个函数的朗斯基行列式是
$$W[e^{-2t},e^{-3t}]=\begin{vmatrix}
e^{-2t}&e^{-3t}\\
-2e^{-2t}&-3e^{-3t}
\end{vmatrix}=-e^{-5t}$$
由于对所有 $t$ $W$ 都不会为零，$y_1,y_2$ 可以被用于构造带初始条件的微分方程的解。3.1 小节的例 3 就是一个例子。

**定理 3.2.4**
> 假定 $y_1,y_2$ 是二阶线性微分方程 $(2)$ 的两个解
> $$L[y]=y''+p(t)y'+q(t)y=0$$
> 解的线性组合
> $$y=c_1y_1(t)+c_2y_2(t)$$
> 其中 $c_1,c_2$ 是任意常量，包含微分方程 $(2)$ 的所有解等价于存在一个 $t_0$ 使得 $y_1,y_2$ 的朗斯基行列式不等于零。

令函数 $\phi$ 是方程 $(2)$ 的解。为了证明上面的定理，需要确定 $\phi$ 是否被线性组合 $c_1y_1+c_2y_2$ 所包含。这就要求确定常量 $c_1,c_2$ 的值，使得线性组合与 $\phi$ 一致。令 $t_0$ 时 $y_1,y_2$ 的朗斯基不等于零。假定 $\phi,\phi'$ 在该点处的值是 $y_0,y_0'$，即
$$y_0=\phi(t_0),y_0'=\phi'(t_0)$$
接下来考虑初值问题
$$y''+p(t)y'+q(t)y=0,y(t_0)=y_0,y'(t_0)=y_0'\tag{12}$$
显然，$\phi$ 是初值问题的解。因为我们假定 $W[y_1,y_2](t_0)$ 不是零，根据定理 3.2.3，可以找到一组 $c_1,c_2$ 使得 $y=c_1y_1(t)+c_2y_2(t)$ 也是初值问题 $(12)$ 的解。$c_1,c_2$ 的值由 $(10),(11)$ 给出。定理 3.2.1 的唯一性确保初值问题的这两个解是同一个，因此选择合适的 $c_1,c_2$ 有
$$\phi=c_1y_1(t)+c_2y_2(t)\tag{13}$$
因此 $\phi$ 被线性组合 $c_1y_1+c_2y_2$ 所包含。最后，由于 $\phi$ 是方程 $(2)$ 的任意解，那么每个解都被线性组合所包含。

现在证明定理的另一个方面。假定没有 $t_0$ 使得朗斯基是非零值，即对每个 $t_0$ 都有 $W[y_1,y_2](t_0)=0$。根据定理 3.2.3，存在 $y_0,y_0'$，不管 $c_1,c_2$ 如何选择都无法满足 $(8)$。选择这样一对 $y_0,y_0'$ 的值和满足初值条件 $(3)$ 的微分方程 $(2)$ 的解 $\phi(t)$。定理 3.2.1 是说初值问题一定有解，不过这个解不被 $y=c_1y_1+c_2y_2$ 所包含。对于所有 $t_0$ 都有 $W[y_1,y_2](t_0)=0$ 的情况，$y_1,y_2$ 的线性组合并不包含方程 $(2)$ 所有解。

定理 3.2.4 表明 $y_1,y_2$ 的朗斯基不处处为零等价于线性组合 $c_1y_1+c_2y_2$ 包含了 $(2)$ 的所有解。很自然地将包含任意常量的解
$$y=c_1y_1(t)+c_2y_2(t)$$
称为 $(2)$ 的通解（`general solution`）。$y_1,y_2$ 组成了 $(2)$ 的基础解系（`fundamental set of solutions`）等价于它们的朗斯基行列式不为零。

定理 3.2.4 也可以解释为：为了找到形式如 $(2)$ 的微分方程的通解，只需要找到两个朗斯基行列式不为零的解。3.1 小节的例子中也是这么做的，虽然当时并没有验证朗斯基行列式的值。

例 4 假定 $y_1(t)=e^{r_1t},y_2(t)=e^{r_2t}$ 是 $(2)$ 的两个解。证明如果 $r_1\neq r2$，$y_1,y_2$ 组成了 $(2)$ 的基础解系。

证明：下面计算 $y_1,y_2$ 的朗斯基行列式
$$W=\begin{vmatrix}
e^{r_1t}&e^{r_2t}\\
r_1e^{r_1t}&r_2e^{r_rt}
\end{vmatrix}=(r_2-r_1)e^{(r1+r2)t}$$
由于 $r_1\neq r_2$，指数函数永远不会为零，那么 $W$ 对所有 $t$ 都不会为零，因此 $y_1,y_2$ 组成了基础解系。

例 5 证明 $y_1(t)=t^{1/2},y_2(t)=t^{-1}$ 是微分方程
$$2t^2y''+3ty'-y=0,t>0\tag{14}$$
的基础解系。

解：首先，$y_1'=\frac{1}{2}t^{-1/2},y_1''=-\frac{1}{4}t^{-3/2}$ 代入微分方程得到
$$2t^2\bigg(-\frac{1}{4}t^{-3/2}\bigg)+3t\frac{1}{2}t^{-1/2}-t^{1/2}=\bigg(-\frac{1}{2}+\frac{3}{2}-1\bigg)t^{1/2}=0$$
类似的，$y_2'=-t^{-2},y_2''=2t^{-3}$，代入方程得到
$$2t^2(2t^{-3})+3t(-t^{-2})-t^{-1}=(4-3-1)t^{-1}=0$$
接着计算 $y_1,y_2$ 的朗斯基行列式
$$W=\begin{vmatrix}
t^{1/2}&t^{-1}\\
\frac{1}{2}t^{-1/2}&-t^{-2}
\end{vmatrix}=(-1-\frac{1}{2})t^{-3/2}=-\frac{3}{2}t^{-3/2}\tag{15}$$
当 $t>0$ 时朗斯基不为零，因此 $y_1,y_2$ 是基础解系，微分方程 $(14)$ 的通解是 $y(t)=c_1t^{1/2}+c_2t^{-1}$。

有时给定微分方程我们能找到基础解系，进而求得通解。但是通常这是一个比较难的事情，形如 $(2)$ 的方程是否总是有基础解系呢？下面的定理给出了肯定的答案。

**定理 3.2.5**
> 微分方程 $(2)$
> $$L[y]=y''+p(t)y'+q(t)y=0$$
> 其中 $o,q$ 在开区间 $I$ 上是连续函数。选择 $I$ 上某点 $t_0$。令 $y_1$ 是 $(2)$ 的解且满足初始条件
> $$y(t_0)=1,y'(t_0)=0$$
> 令 $y_2$ 也是 $(2)$ 的解且满足初始条件
> $$y(t_0)=0,y'(t_0)=1$$
> 那么 $y_1,y_2$ 是 $(2)$ 的基础解系。

定理 3.2.1 保证了解 $y_1,y_2$ 的存在性。为了证明是基础解系，只需要计算朗斯基行列式
$$W[y_1,y_2](t_0)=\begin{vmatrix}
y_1(t_0)&y_2(t_0)\\
y_1'(t_0)&y_2'(t_0)
\end{vmatrix}=\begin{vmatrix}
1&0\\0&1
\end{vmatrix}=1$$
在 $t_0$ 点处朗斯基不为零，$y_1,y_2$ 是基础解系。

定理 3.2.5 并没有表明如何通过解特殊的初值问题来找到 $y_1,y_2$，它只能确保基础解系一定存在。

例 6 根据定理 3.2.5 求微分方程
$$y''-y=0\tag{16}$$
的基础解系 $y_1,y_2$，给定 $t_0=0$。

解：3.1 小节中给出了 $(16)$ 的两个解 $y_1(t)=e^t,y_2(t)=e^{-t}$，其朗斯基是 $W[y_1,y_2](t)=-2\neq 0$，那么可以组成基础解系。不过由于不满足定理 3.2.5 中 $t=0$ 的初始条件，它们不是定理 3.2.5 中给出的基础解系。

为了找到定理给定的基础解系，需要找到满足初始条件的解。令 $(16)$ 的解 $y_3(t)$ 满足初始条件
$$y(0)=1,y'(0)=0\tag{17}$$
$(16)$ 的通解是
$$y=c_1e^t+c_2e^{-t}\tag{18}$$
满足初始条件 $(17)$ 的 $c_1=1/2,c_2=1/2$，那么
$$y_3(t)=\frac{1}{2}e^t+\frac{1}{2}e^{-t}=\cosh t$$
类似的，如果 $y_4(t)$ 满足初始条件
$$y(0)=0,y'(0)=1\tag{19}$$
那么
$$y_4(t)=\frac{1}{2}e^t-\frac{1}{2}e^{-t}=\sinh t$$
$y_3,y_4$ 的朗斯基是
$$W[y_3,y_4](t)=\cosh^2 t-\sinh^2=1$$
这就是定理 3.2.5 给定的基础解系。因此 $(16)$ 的通解是
$$y=k_1\cosh t+k_2\sinh t\tag{20}$$
形式和 $(18)$ 类似。这里使用 $k_1,k_2$ 表示任意常量是为了与之前的任意常量 $c_1,c_2$ 区别开来。

这个例子的目的之一是说明一个微分方程有不止一组基础解系，事实上，有无限多。选择最方便的一组基础解系即可。

下一小节会遇到复数解，下面的定理对这样的微分方程及其解至关重要。

**定理 3.2.6**
> 二阶线性微分方程 $(2)$
> $$L[y]=y''+p(t)y'+q(t)y=0$$
> 其中 $p,q$ 是连续实函数。如果 $y=u(t)+iv(t)$ 是微分方程 $(2)$ 的复数解，那么实部 $u$ 和虚部 $v$ 也是这个微分方程的解。

将解 $u(t)+iv(t)$ 代入 $L[y]$，那么
$$\begin{aligned}
L[y](t)&=u''(t)+iv''(t)+p(t)(u'(t)+iv'(t))+q(t)(u(t)+iv(t))\\
&=(u''(t)+p(t)u'(t)+q(t)u(t))+i(v''(t)+p(t)v'(t)+q(t)v(t))\\
&=L[u](t)+iL[v](t)
\end{aligned}\tag{21}$$
复数等于零等价于实部和虚部都等于零。因此由 $L[y]=0$ 得到 $L[u]=0,L[v]=0$，那么这两个实函数 $u,v$ 也是 $(2)$ 的解。在 3.3 小节会看到这样的例子。

解的 $y$ 的复共轭 $\bar{y}$ 也是 $(2)$ 的解。这个证明与上述证明定理 3.2.6 类似，也可以从 $y=u(t)-iv(t)$ 是两个解 $u,v$ 的线性组合角度证明这个结果。

下面进一步讨论二阶线性齐次微分方程的两个解的朗斯基的特性。下面这个定理给出了在不知道解的情况下的一个相当简答的任意微分方程的两个解的朗斯基行列式的公式。

**定理 3.2.7 (阿贝尔定理 Abel's Theorem)**
> 如果 $y_1,y_2$ 是二阶线性微分方程
> $$L[y]=y''+p(t)y'+q(t)y=0\tag{22}$$
> 的解，其中 $p,q$ 在开区间 $I$ 上连续，那么朗斯基行列式是
> $$W[y_1,y_2](t)=c\exp{\bigg(-\int p(t)dt\bigg)}\tag{23}$$
> $c$ 是依赖于 $y_1,y_2$ 的常量，并不依赖于 $t$。$W[y_1,y_2](t)$ 在 $I$ 上要么都是 0（$c=0$）要么都不是 0（$c\neq 0$）。

为了证明这个定理，我们从 $y_1,y_2$ 满足
$$\begin{aligned}
y_1''+p(t)y_1'+q(t)y_1=0\\
y_2''+p(t)y_2'+q(t)y_2=0\\
\end{aligned}\tag{24}$$
第一个式子乘以 $-y_2$，第二个式子乘以 $y_1$，相加得到
$$y_1y_2''-y_1''y_2+p(t)(y_1y_2'-y_1y_2)=0\tag{25}$$
令 $W(t)=W[y_1,y_2](t)$，容易得到
$$W'=y_1y_2''-y_1''y_2\tag{26}$$
那么 $(25)$ 可以写作
$$W'+p(t)W=0\tag{27}$$
这是 2.1 小节分析的一阶线性微分方程，也是 2.2 小节分析的可分离变量微分方程，因此解是
$$W(t)=c\exp{\bigg(-\int p(t)dt}\bigg)\tag{28}$$
其中 $c$ 是常量。

$c$ 依赖于 $(22)$ 的一对解。由于指数函数的值不会是零，那么 $c=0$ 就意味着对所有 $t$ 都有 $W=0$，否则 $W\neq 0$。

同一个微分方程不同基础解系的朗斯基对应的乘法常量不同，只需要确定 $c$ 无需解出基础解系，就能确定朗斯基的值。根据定理 3.2.7，朗斯基要么全是零，要么全部是零，因此在方便的 $t$ 时求朗斯基是那种情况就好。

例 7 在例 5 中 $y_1=t^{1/2},y_2=t^{-1}$ 是微分方程
$$2t^2y''+3ty'-y=0,t>0\tag{29}$$
的基础解系，根据公式 $(23)$ 确定 $y_1,y_2$ 的朗斯基。

解：从例 5 中可以得到 $W[y_1,y_2](t)=-\frac{3}{2}t^{-3/2}$。为了使用 $(23)$ 需要将 $(29)$ 写作标准形式
$$y''+\frac{3}{2t}y'-\frac{1}{2t^2}y=0$$
所以 $p(t)=\frac{3}{2t}$，那么
$$\begin{aligned}
W[y_1,y_2](t)&=c\exp{\bigg(\int -p(t)dt\bigg)}\\
&=c\exp{\bigg(-\int\frac{3}{2t}dt\bigg)}\\
&=c\exp{\bigg(-\frac{3}{2}\ln t\bigg)}\\
&=ct^{-3/2}
\end{aligned}\tag{30}$$
$(30)$ 给出了方程 $(29)$ 任意基础解系的朗斯基。对于例子中给出的一组基础解系，那么 $c=-\frac{3}{2}$。

### 总结
为了求微分方程
$$y''+p(t)y'+q(t)y=0,\alpha<t<\beta$$
的通解，首先找到满足微分方程的两个解 $y_1,y_2$，需要确定在 $(\alpha,\beta)$ 区间上至少有一点使得 $y_1,y_2$ 的朗斯基 $W$ 不为零。这种情况下，$y_1,y_2$ 组成了基础解系，那么通解是
$$y=c_1y_1(t)+c_2y_2(t)$$
其中 $c_1,c_2$ 是任意常数。如果给定了 $\alpha<t<\beta$ 上某点处的初始条件，那么可以确定 $c_1,c_2$ 使之满足初始条件。
